(def element ModalCoachWindowCompleteAccount ()
	(macro MODAL_WINDOW_INIT)
	(macro MODAL_WINDOW_BG)

	(scope
		(var rewards:array = "getSingleComponent(CC.completionRewards).rewards")
	)

	(block
		(class $EyeLevelAligned)
		(style
			(width = 980px)
			(align = "center")
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
			(style
				(width = 100%)
				(marginBottom = "MS")
			)

			(element ModalWindowHeaderFullSize
				_windowName = 'IDS_ACCOUNT_COMPLETION_PROMO_HEADER'
				_hideBackButton = true
				_hideCloseButton = true
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 2)
			(style
				(width = 100%)
				(marginBottom = "LM")
			)

			(tf
				(class $TextDefault20NM)
				(style
					(width = 100%)
					(height = 50px)
					(textAlign = "center")
					(alpha = "TA")
				)
				(text = 'IDS_ACCOUNT_COMPLETION_PROMO_DESCRIPTION')
			)
		)

		(hblock
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)
			(style
				(align = "center|middle")
				(marginBottom = "LM")
				(hgap = "SXS")
			)

			(controller $Repeat renderer='AccountCompletionRewardItem' count="rewards.length"
				(args
					_rewardEntityId = "rewards[$index]"
				)
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 3.5)
			(style
				(width = 100%)
				(marginBottom = "LS")
			)
			(element HorizontalDividerTwoPx)
		)

		(hblock
			(style
				(width = 100%)
				(align = "center")
			)

			(block
				(macro DEFAULT_MODAL_WINDOW_ANIMATION 4)
				(style (marginRight = "M"))

				(element DefaultButton
					_label = 'IDS_ACCOUNT_COMPLETION_PROMO_BTN'
					_width = 180px
					_focusIndex = 0
					_defaultFocused = true
					_methods = "[{type: 'inputMapping.onAction', name: 'menuItemClicked', args: { menuId: SC.Ui_common.MENU.PLAYER_MENU, itemId: SC.Ui_windows.MODAL.COMPLETE_ACCOUNT }}]"
				)
			)

			(block
				(macro DEFAULT_MODAL_WINDOW_ANIMATION 4)
				(element DefaultButton
					_width = 180px
					_type = "SC.Ui_styles.BUTTON_TYPE.SECONDARY"
					_label = 'IDS_CLOSE_UPPER_CASE'
					_name = 'btn_cancel'
					_focusIndex = 1
				)
			)
		)
	)
)

(def element AccountCompletionRewardItem (_rewardEntityId:number)
	(style (backgroundColor = "NO_COLOR"))

	(controller $Tooltip
		(renderer = 'AccountCompletionRewardItemTooltip')
		(args
			_rewardEntityId = "_rewardEntityId"
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)

	(block
		(style (hitTest = false))

		(element RewardBigCard
			_rewardEntityId = "_rewardEntityId"
		)
	)
)

(def element AccountCompletionRewardItemTooltip (_rewardEntityId:number)
	(scope
		(macro TOOLTIP_SYSTEM_DEFAULT_BACKGROUND_SCOPE)

		(var rewardEntity:dhEntity = "getEntity(_rewardEntityId)")

		(struct rewardSubtype = CORRECT_REWARD_RESOURCE_SUBNAME(_subtype = "rewardEntity.rewardComponent.subtype"))

		(var isPremium:bool = "rewardSubtype.value == SC.Common.REWARD_SUBTYPE.PREMIUM || rewardSubtype.value == 'mk_premium'")
		(var isLootbox:bool = "rewardEntity.rewardComponent.type == SC.Common.REWARD_TYPE.LOOTBOX")

		(var tooltipDescHeader:str = "  isPremium 	? SC.Common.REWARD_SUBTYPE.PREMIUM :
										isLootbox 	? SC.Common.REWARD_TYPE.LOOTBOX
													: SC.Common.REWARD_TYPE.RESOURCE")

		(var priceLineRenderer:str = "	isPremium	? 'TooltipSystemDescriptionText' :
										isLootbox	? 'TooltipSystemCounterLine'
													: 'TooltipSystemPriceTagLine'")
	)
	(style (width = 340px))

	(macro TOOLTIP_SYSTEM_DEFAULT_BACKGROUND_MARKUP)
	(element TOOLTIP_SYSTEM_DEFAULT_CONTAINER
		(element TooltipSystemHeaderWithIconAndText
			_imageUrl = "'url:../reward_icons/' + rewardSubtype.value + '.png'"
			_imageWidth = 80px
			_imageHeight = 80px
			_headerText = "(isLootbox ? 'IDS_REWARD_LOOTBOX_' : 'IDS_REWARD_') + rewardSubtype.value + '_TITLE'"
			_unifiedStatus = "SC.Ui_styles.UNIFIED_STATUS.DEFAULT"
		)
		(element TooltipSystemHorizontalDivider)

		(block
			(style (width = 100%))

			(controller $Instance
				(bind renderer "priceLineRenderer")
				(args
					_title = 'IDS_ACCOUNT_COMPLETION_REWARD_TOOLTIP_WILL_RECEIVE'
					_descriptionText = "subst('IDS_ACCOUNT_COMPLETION_REWARD_TOOLTIP_WILL_RECEIVE_SUBST', [], {_amount: rewardEntity.rewardComponent.params.text})"
					_priceInfo = "{currency: rewardSubtype.value, finalPrice: rewardEntity.rewardComponent.amount}"
					_count = "rewardEntity.rewardComponent.amount"
				)
			)
		)

		(element TooltipSystemHorizontalDivider)
		(element TOOLTIP_SYSTEM_ELEMENTS_GROUP
			(element TOOLTIP_SYSTEM_GROUP_ELEMENT
				(element TooltipSystemSecondaryHeaderText _headerText = "'IDS_ACCOUNT_COMPLETION_REWARD_TOOLTIP_HEADER_' + tooltipDescHeader")
			)
			(element TOOLTIP_SYSTEM_GROUP_ELEMENT
				(element TooltipSystemDescriptionText _descriptionText = "'IDS_ACCOUNT_COMPLETION_REWARD_TOOLTIP_DESC_' + rewardSubtype.value")
			)
		)

		(element TooltipSystemHorizontalDivider)
		(element TOOLTIP_SYSTEM_ELEMENTS_GROUP
			(element TOOLTIP_SYSTEM_GROUP_ELEMENT
				(element TooltipSystemSecondaryHeaderText _headerText = 'IDS_CURRENCY_HOW_TO_GET_TITLE')
			)
			(element TOOLTIP_SYSTEM_GROUP_ELEMENT
				(element TooltipSystemDescriptionText _descriptionText = "'IDS_ACCOUNT_COMPLETION_REWARD_TOOLTIP_HOW_TO_GET_DESC_' + rewardSubtype.value")
			)
		)
	)
)
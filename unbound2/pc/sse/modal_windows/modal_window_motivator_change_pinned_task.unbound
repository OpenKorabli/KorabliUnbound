(def element ModalWindowMotivatorChangePinnedTask (sseID:str)
	(macro MODAL_WINDOW_INIT)
	(macro MODAL_WINDOW_BG)

	(scope
		(event evChangeSelectedSseId)

		(var pinnedTasks:dhCollection = "getCollectionByPath(CC.sseCore, 'motivator.pinned')")
		(var selectedSseId:number = "$event.selectedSseId ?: 0" (event "evChangeSelectedSseId"))
		(var itemToUnpinID:str = "$event.sseID ?: ''" (event "evChangeSelectedSseId"))
	)
	(block
		(class $EyeLevelAligned)

		(style
			(width = 576px)
			(align = "center")
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 0)
			(style
				(width = 100%)
				(marginBottom = "MS")
			)
			(element ModalWindowShortHeader
				_header = 'IDS_SSE_MOTIVATOR_CHANGE_PINNED_TASK_TITLE'
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
			(tf
				(class $TextDefaultNM)
				(style
					(marginBottom = "MS")
					(textAlign = "center")
					(alpha = "TA")
				)
				(text = 'IDS_SSE_MOTIVATOR_CHANGE_PINNED_TASK_STATUS_WARNING')
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 1.5)
			(tf
				(class $TextDefault22NM)
				(style
					(marginBottom = "MS")
					(alpha = "TA")
				)
				(text = 'IDS_SSE_MOTIVATOR_CHANGE_PINNED_TASK_SUBTITLE')
			)
		)

		(htile
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 2)
			(style
				(width = 100%)
				(marginBottom = "MS")
				(hgap = "M")
			)
			(controller $Repeat renderer='SsePinnedTaskItem'
				(bind count "pinnedTasks.length")
				(args
					_sseId = "pinnedTasks[$index].id"
					_selectedSseId = "selectedSseId"
				)
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)
			(style (marginBottom = "MS"))
			(element StatusLine
				_unifiedStatus = "SC.Ui_styles.UNIFIED_STATUS.INFO"
				_text = 'IDS_SSE_MOTIVATOR_CHANGE_PINNED_TASK_STATUS_INFO'
			)
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)

			(element ModalWindowSystemYesNoButtons
				_isForceBtnOkVisible = true
				_isBtnOkDefaultFocused = false
				_btnOkFocusIndex = 1
				_btnNoFocusIndex = 2
				_btnOkLabel = 'IDS_CHOOSE'
				_btnNoLabel = 'IDS_CLOSE_UPPER_CASE'
				_btnOkName = 'btn_ok'
				_btnOkTooltipText = 'IDS_SSE_MOTIVATOR_TASK_CHOOSE_BUTTON_TOOLTIP'
				_isBtnOkEnabled = "selectedSseId != 0"
				_btnOkMethods = "[
									{
										type: 'inputMapping.onAction',
										name: 'SSEProxyCommonUSS.repinSSEElement',
										args: {oldSSEID: itemToUnpinID, newSSEID: sseID}
									}
								]"
			)
		)
	)
)

(def element SsePinnedTaskItem (_sseId:number = 0, _selectedSseId:number = 0)
	(scope
		(struct mouseHandler = MOUSE_HANDLER())

		(var sseEntity:dhEntity = "getEntity(_sseId)")
		(var sseCore:dhComponent = "sseEntity.sseCore")
		(var isSseItemSelected:bool = "sseEntity.id == _selectedSseId")
		(var isManualRewardClaim:bool = "	sseEntity.sseChain.claimRewards ||
											sseEntity.sseEpic.claimRewards ||
											sseEntity.sseTask.claimRewards")
		(var bgState:number = " isSseItemSelected		? SC.Ui_styles.BUTTON_STATE.SELECTED :
								mouseHandler.mouseDown	? SC.Ui_styles.BUTTON_STATE.DOWN :
								mouseHandler.rollOver	? SC.Ui_styles.BUTTON_STATE.OVER
														: SC.Ui_styles.BUTTON_STATE.UP")
	)
	(style
		(width = "EVENT_BANNER_WIDTH.MEDIUM")
		(height = "EVENT_BANNER_HEIGHT.MEDIUM")
	)

	(element MotivatorTaskCardBackground
		_bgState = "bgState"
	)

	(block
		(class $Fullsize)
		(style
			(paddingTop = "M")
			(paddingLeft = "M")
			(paddingRight = "M")
			(paddingBottom = "SXS")
		)
		(element SseMotivatorTaskActive
			_sseId = "_sseId"
		)
	)

	(block
		(class $FullsizeAbsolute)

		(element MOUSE_HANDLER_CONTAINER
			(macro STRUCT_MOUSE_DISPATCHER
				_mouseHandler = "mouseHandler"
			)

			(macro STRUCT_SOUND_HANDLER
				_mouseHandler = "mouseHandler"
				_soundSet = "'button_secondary'"
			)

			(macro STRUCT_DISPATCH_HANDLER
				_mouseHandler = "mouseHandler"
				_dispatchedEv = "'evChangeSelectedSseId'"
				_dispatchParams = "{ selectedSseId: sseEntity.id, sseID:sseCore.id }"
			)
		)
	)

	(controller $Tooltip
		(renderer = 'SseMotivatorBannerTooltip')
		(args
			_sseId = "_sseId"
			_isRewardChoice = "isManualRewardClaim"
			_hasMouseInstruction = "!isSseItemSelected"
			_mouseInstructionText = 'IDS_SSE_MOTIVATOR_TASK_CHOOSE_MOUSE_INSTRUCTION'
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)
)
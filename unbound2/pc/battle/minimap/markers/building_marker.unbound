(def constant BUILDING_TYPE_SYMBOL_NAME "{
	CoastalArtillery: 'ground_artillery',
	AntiAircraft: 'ground_air_defence',
	SensorTower: 'ground_radar',
	Complex: 'ground_artillery',
	Military: 'ground_supply',
	RayTower: 'ground_tower',
	AirBase: 'ground_airbase',
	Generator: 'ground_supply',
	SpaceStation: 'ground_station'
}")

(def element MapBuildingMarker (_markerEntity:gfx, _mapScale:number, _itemScale:number, _scaleRatio:number)
	(scope
		(var markerScale:number = "_itemScale / _mapScale")

		(var buildingComponent:gfx = "_markerEntity.building")
		(var isSuppressed:bool = "buildingComponent.isSuppressed" (event "buildingComponent.evSuppressionChanged"))

		(var healthComponent:gfx = "_markerEntity.health" (event "_markerEntity.evAdded"))
		(var isAlive:bool = "healthComponent.isAlive" (event "healthComponent.evIsAliveChanged"))

		(var mapVisible:bool = "_markerEntity.visibility.mapVisible" (event "_markerEntity.visibility.evChanged"))

		(macro VAR_RELATION "_markerEntity")

		(var symbolName:str = "BUILDING_TYPE_SYMBOL_NAME[buildingComponent.type]")
		(var suppressedStr:str = "isSuppressed ? '_suppressed' : ''")
		(var relationStr:str = "'_' + (relation == RELATION_NAMES.OWN ? RELATION_NAMES.NEUTRAL : relation)")

		(var markerIcon:str = "	!mapVisible ? 'swf:../battle_hud/markers/building_icons_svg/building_icons_svg.swf:' + symbolName + '_last_visible' :
								isAlive 	? 'swf:../battle_hud/markers/building_icons_svg/building_icons_svg.swf:' + symbolName + suppressedStr + relationStr
											: 'swf:../battle_hud/markers/building_icons_svg/building_icons_svg.swf:' + symbolName + '_dead'"
		)

		(macro SCOPE_HIGHLIGHT_MARKER_ON_MAP_MOUSE_OVER "_markerEntity")
	)

	(macro BIND_FAIR_SCALE "markerScale")

	(block
		(macro EFFECT_HIGHLIGHT_MARKER_ON_MOUSE_OVER)
		(style
			(width = 24px)
			(height = 24px)
			(visualOffsetX = -50%)
			(visualOffsetY = -50%)
			(bind backgroundImage "markerIcon")
		)
	)
)
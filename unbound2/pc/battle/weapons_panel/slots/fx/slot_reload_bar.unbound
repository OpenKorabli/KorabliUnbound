(def constant SLOT_RELOAD_FONT_SIZE 27px)
(def constant SLOT_RELOAD_FX_MARGINS 4px) 

(def element SlotReloadBar (_isShowTime:bool=true, _isCharging:bool=false, _isWorking:bool=false, _isInverted:bool=true, _percentPassed:number=0, _remainTime:number=0)
	(scope
		(macro HUMAN_READABLE_COUNTDOWN_SCOPE "_remainTime")

		(var percentPassed:number = "abs((_isWorking && _isInverted ? 0 : 1) - _percentPassed)")
		(var progress:number = "percentPassed")
		(var curMaskY:number = "SLOT_SIZE * (1 - progress)")
	)

	(style
		(position = "absolute")
		(top = "-SLOT_RELOAD_FX_MARGINS")
		(left = "-SLOT_RELOAD_FX_MARGINS")
		(align = "center|middle")
		(width = "SLOT_FX_SIZE")
		(height = "SLOT_FX_SIZE")
	)

	
	(block
		(class $FullsizeAbsolute)
		(style (backgroundImage = 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_bg.png'))
	)

	
	(block
		(style
			(position = "absolute")
			(width = "SLOT_SIZE")
			(height = "SLOT_SIZE")
			(top = "SLOT_RELOAD_FX_MARGINS")
			(left = "SLOT_RELOAD_FX_MARGINS")
		)

		(block
			(style
				(position = "absolute")
				(top = "-SLOT_RELOAD_FX_MARGINS")
				(left = "-SLOT_RELOAD_FX_MARGINS")
			)
			(block
				(style
					(bind backgroundImage "	_isWorking 	? 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_tint_green.png' :
											_isCharging	? 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_tint_blue.png'
														: 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_tint_orange.png'")
				)
			)
		)

		(block
			(style
				(position = "absolute")
				(left = "-SLOT_RELOAD_FX_MARGINS")
				(bind top "curMaskY")
			)
			(block
				(style
					(bind backgroundImage "	_isWorking 	? 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_bar_green.png' :
											_isCharging	? 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_bar_blue.png'
														: 'url:../battle_hud/weapons_panel/slot/weapon_panel_slot_bar_orange.png'")
				)
			)
		)

		(block
			(class $FullsizeAbsolute)
			(style
				(backgroundColor = "SC.Ui_styles.SERVICE_COLORS.BLACK")
				(bind top "curMaskY")
			)
			(isMask = true)
		)
	)

	(tf
		(bind visible "_isShowTime")
		(class $ActionPanelTimerCountdown)
		(style
			(fontSize = "SLOT_RELOAD_FONT_SIZE")
			(bind textColor "	_isWorking	? C_ACTIVE :
								_isCharging	? 0xFF07CEFA
											: 0xFFFED37A"
			)
		)
		(macro TFMouseEnabled value=false)
		(bind text "countdownText")
	)
)
(def element MaintenanceWidget (_shipId:number)
	(scope
		(var shipEntity:dhEntity =			"getPrimaryEntity(CC.ownShip, _shipId)")
		(var ownShipComponent:dhComponent =	"shipEntity.ownShip")

		(var isNeedRepair:bool =		"ownShipComponent.isNeedRepair"			(event "ownShipComponent.evUpdateDockState"))
		(var creditsDeficit:number =	"ownShipComponent.creditsDeficit"		(event "ownShipComponent.evCreditsDeficitChanged"))
		(var costRepair:number =		"ownShipComponent.costRepair"			(event "ownShipComponent.evUpdateDockState"))

		(var isServeShipButtonVisible:bool = "isNeedRepair && creditsDeficit <= 0")
	)

	(bind visible "isNeedRepair")

	(class $TTXWidgetContainer)

	(block
		(class $FullsizeAbsolute)
		(element DockWidgetBackground)
	)

	(block
		(style
			(width = 100%)
			(paddingLeft = "M")
			(paddingRight = "SXS")
			(paddingTop = "M")
			(paddingBottom = "M")
		)

		(tf
			(class $TextDefaultBold18NM)
			(style
				(width = 100%)
				(textColor = "SC.Ui_styles.SERVICE_COLORS.ORANGE")
				(marginBottom = "M")
			)

			(text = 'IDS_SHIP_NEEDS_SERVICE_MESSAGE')
		)

		(block
			(style
				(width = 100%)
				(vgap = "S")
				(bind marginBottom "isServeShipButtonVisible ? M : 0")
			)

			(block
				(style (width = 100%))

				(controller $Instance renderer='PriceTagWithLabel'
					(bind enabled "isNeedRepair && costRepair > 0")
					(args
						_priceInfo =	"{ finalPrice: costRepair, currency: SC.Common.CURRENCIES.CREDITS }"
						_label =		'IDS_COST_COLON'
						_size =			"SIZE.MEDIUM"
						_width =		100%
					)
				)
			)

			(block
				(style (width = 100%))

				(controller $Instance renderer='PriceTagWithDeficitAndLabelRow'
					(bind enabled "isNeedRepair && creditsDeficit > 0")
					(args
						_priceInfo =	"{ finalPrice: creditsDeficit, currency: SC.Common.CURRENCIES.CREDITS }"
						_title =		'IDS_NOT_ENOUGH'
						_size =			"SIZE.MEDIUM"
					)
				)
			)
		)

		(block
			(style (width = 100%))

			(controller $Instance renderer='DefaultButton'
				(bind enabled "isServeShipButtonVisible")
				(args
					_label =	'IDS_PURCHASE_BUTTON'
					_methods =	"[{ type: 'inputMapping.onAction', name: 'DockProxy.onServeShip', args: { shipId: _shipId } }]"
					_width =	100%
				)
			)
		)
	)
)
(def constant SECONDARY_DOCK_TAB_HEIGHT 34px)
(def constant SECONDARY_DOCK_TAB_RESEARCH_HEIGHT 34px)

(def constant DOCK_SECONDARY_TAB_BUTTON_ICON_ALPHA "{
	SC.Ui_styles.BUTTON_STATE.DISABLED:	0.45,
	SC.Ui_styles.BUTTON_STATE.SELECTED:	1,
	SC.Ui_styles.BUTTON_STATE.DOWN:		0.8,
	SC.Ui_styles.BUTTON_STATE.OVER:		1,
	SC.Ui_styles.BUTTON_STATE.UP:		1
}")

(def element DockSecondaryTabButtonWrapper (_route:str, _routeLen:number)
	(scope
		(var isResearchTreeTab:bool = "_route in SC.Common.NATION.RESEARCH_TREE_ORDER")
		(var renderSecondaryTabItem:str = "isResearchTreeTab	? 'NationTabButton'
																: ROUTE_SECONDARY_TAB_ELEMENTS[_route]")
	)
	(bind name "isResearchTreeTab ? 'NationTabButton_' + _route : ROUTE_SECONDARY_TAB_ELEMENTS[_route]")

	(controller $Instance
		(bind renderer "renderSecondaryTabItem")
		(args
			_nationRoute =		"_route"
			_sidePaddings =		"$index == _routeLen - 1	? { left: DOCK_TAB_PADDINGS.SIDE_LEFT, right: DOCK_TAB_PADDINGS.DEFAULT } :
								 $index == 0				? { left: DOCK_TAB_PADDINGS.DEFAULT, right: DOCK_TAB_PADDINGS.SIDE_RIGHT }
															: { left: DOCK_TAB_PADDINGS.DEFAULT, right: DOCK_TAB_PADDINGS.DEFAULT }"
		)
	)
)

(def struct DOCK_SECONDARY_TAB_BUTTON_LOCKED_SHIP_NOT_OWNED_REASON (_viewedShipId:number)
	(var ownShipEntity:dhEntity = 	"getPrimaryEntity(CC.ownShip, _viewedShipId)")
	(var shipEntity:dhEntity = 		"getPrimaryEntity(CC.ship, _viewedShipId)")

	(var ownShipInfo:dhComponent = 	"ownShipEntity.ownShip")
	(var shipInfo:dhComponent = 	"shipEntity.ship")

	(var isOwned:bool = "ownShipEntity != null")

	(var value:str = "!isOwned 	? SC.Ui_common.DOCK_TAB_LOCKED_REASON.SHIP_NOT_OWNED
								: SC.Ui_common.DOCK_TAB_LOCKED_REASON.NO_REASON")
	
	(var unifiedStatus:str = "SC.Ui_styles.UNIFIED_STATUS.WARNING")

	(var isActive:bool = "value != SC.Ui_common.DOCK_TAB_LOCKED_REASON.NO_REASON")
)













(def element SecondaryTabButtonWaffentrager (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct waffentragerRoute = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.WAFFENTRAGER"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.WAFFENTRAGER"))
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_WAFFENTRAGER'
		_isSelected = "waffentragerRoute.isActive"
		_isEnabled = "waffentragerRoute.isEnabled"
		_markerType = "markerData.markerType"
		_methods = "[	{
							type: 'inputMapping.onAction',
							name: 'navigateTo',
							args: { route: SC.Ui_windows.ROUTE.WAFFENTRAGER }
						}]"
		_sidePaddings = "_sidePaddings"
	)
)

(def element SecondaryTabButtonEvents (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.EVENTS_PORT"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.EVENTS"))

		(struct newEventAvailableTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.NEW_EVENT_AVAILABLE"))

		(var newTipId:number = "newEventAvailableTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.NEW_EVENT_AVAILABLE
																: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)
	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_EVENTS'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[	{
							type: 'inputMapping.onAction',
							name: 'navigateTo',
							args: { route: SC.Ui_windows.ROUTE.EVENTS_PORT }
						}]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =				"newTipId"
			_tipPositioning =		"TIP_POSITION_BOTTOM"
			_pointerOffset =		-18
			_alongPointerOffset =	0
			_screenOffsetLeft =		10
			_modalWindowName =		"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonSse (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.SSE"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.SSE"))

		(struct featureSse = FEATURES(_state = "SC.Common.ACCOUNT_FEATURE.ACTIONS_USE"))
		(var isFeatureSseLocked:bool = "featureSse.state == 'locked'")
		(var title:str = "isFeatureSseLocked	? 'IDS_DOCK_BANNER_SSE_NEWBIE_QUESTS'
												: 'IDS_DOCK_BANNER_SSE_BATTLE_TASKS'")

		(struct newbieQuestsIntroTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.NEWBIE_QUESTS_INTRO"))
		(struct sseIntroTip =				PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.SSE_INTRO"))
		(struct campaignSecondaryTabTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.CAMPAIGN_SECONDARY_TAB"))
		(struct shipAcesTip =				PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES"))
		(struct shipAcesNationTip =			PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES_NATION"))
		(struct shipAcesShipTypeTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES_SHIP_TYPE"))

		(var newTipId:number = "newbieQuestsIntroTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.NEWBIE_QUESTS_INTRO :
								sseIntroTip.isActive				? SC.Context_guiding_tip.TIP_TYPE.SSE_INTRO :
								campaignSecondaryTabTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.CAMPAIGN_SECONDARY_TAB :
								shipAcesTip.isActive				? SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES :
								shipAcesNationTip.isActive			? SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES_NATION :
								shipAcesShipTypeTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.SHIP_ACES_SHIP_TYPE
																	: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)

	(element DockSecondaryTabButton
		_label =				"title"
		_isEnabled =			"routeMenuData.isEnabled"
		_isSelected =			"routeMenuData.isActive"
		_markerType =			"markerData.markerType"
		_markerNewCounter =		"markerData.markerCounter"
		_methods =				"[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.SSE } }]"
		_sidePaddings =			"_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =				"newTipId"
			_tipPositioning =		"TIP_POSITION_BOTTOM"
			_pointerOffset =		-18
			_alongPointerOffset =	-10
			_screenOffsetLeft =		10
			_modalWindowName =		"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonLootboxes (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.LOOTBOXES"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.LOOTBOXES"))


		(struct lootboxesTabTip =			PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.LOOTBOXES_SELF_TAB"))
		(struct lootboxesTabRepeatTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.LOOTBOXES_SELF_TAB_REPEAT"))

		(var newTipId:number = "lootboxesTabTip.isActive			? SC.Context_guiding_tip.TIP_TYPE.LOOTBOXES_SELF_TAB :
								lootboxesTabRepeatTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.LOOTBOXES_SELF_TAB_REPEAT
																	: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_LOOTBOXES'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.LOOTBOXES } }]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonShipMastery (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.SHIP_MASTERY"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.SHIP_MASTERY"))

		(struct shipMasteryIntroTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.SHIP_MASTERY_INTRO"))

		(var newTipId:number = "shipMasteryIntroTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.SHIP_MASTERY_INTRO
																: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_SHIP_MASTERY'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[	{
							type: 'inputMapping.onAction',
							name: 'navigateTo',
							args: { route: SC.Ui_windows.ROUTE.SHIP_MASTERY }
						}]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonOverview (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.OVERVIEW"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.OVERVIEW"))


		(struct portBuffGoToOverviewTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.PORT_BUFF_FOR_EVENT_GO_TO_OVERVIEW_TAB"))

		(var newTipId:number = "portBuffGoToOverviewTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.PORT_BUFF_FOR_EVENT_GO_TO_OVERVIEW_TAB
																	: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_OVERVIEW'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{
						type: 'inputMapping.onAction',
						name: 'navigateTo',
						args: { route: SC.Ui_windows.ROUTE.OVERVIEW }
					}]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =				"newTipId"
			_tipPositioning =		"TIP_POSITION_BOTTOM"
			_pointerOffset =		-18
			_alongPointerOffset =	-96
			_modalWindowName =		"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonUpgrades (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.UPGRADES"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.UPGRADES"))

		(struct signalsUpgradesTabTip =				PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.BATTLE_BONUS_UPGRADES_TAB"))
		(struct signalsUpgradesTabRepeatTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.BATTLE_BONUS_UPGRADES_TAB_REPEAT"))
		(struct freeXPModuleUpgradesTabTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.FREE_XP_MODULE_UPGRADES_TAB"))
		(struct freeXPModuleUpgradesTabRepeatTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.FREE_XP_MODULE_UPGRADES_TAB_REPEAT"))
		(struct modernizationsSecondaryTabTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.MODERNIZATIONS_SECONDARY_TAB"))

		(var newTipId:number = "signalsUpgradesTabTip.isActive				? SC.Context_guiding_tip.TIP_TYPE.BATTLE_BONUS_UPGRADES_TAB :
								signalsUpgradesTabRepeatTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.BATTLE_BONUS_UPGRADES_TAB_REPEAT :
								freeXPModuleUpgradesTabTip.isActive			? SC.Context_guiding_tip.TIP_TYPE.FREE_XP_MODULE_UPGRADES_TAB :
								freeXPModuleUpgradesTabRepeatTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.FREE_XP_MODULE_UPGRADES_TAB_REPEAT :
								modernizationsSecondaryTabTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.MODERNIZATIONS_SECONDARY_TAB
																			: SC.Context_guiding_tip.TIP_TYPE.NONE")
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_UPGRADES'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.UPGRADES } }]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def element SecondaryTabButtonCrewManagement (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.CREW_MANAGEMENT"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.CREW_MANAGEMENT"))

		(struct crewTabTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.CREW_SECONDARY_TAB"))

		(var newTipId:number = "crewTabTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.CREW_SECONDARY_TAB
														: SC.Context_guiding_tip.TIP_TYPE.NONE")



		
		(macro PULL_SHIP_ID)

		(struct tabLockedReasonNotOwned = DOCK_SECONDARY_TAB_BUTTON_LOCKED_SHIP_NOT_OWNED_REASON (_viewedShipId = "viewedShipId"))

		(var tabLockedReason:dict = "	tabLockedReasonNotOwned.isActive 	? { text: tabLockedReasonNotOwned.value,
																				unifiedStatus: tabLockedReasonNotOwned.unifiedStatus }
																			: null")

	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_CREW_MANAGEMENT'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.CREW_MANAGEMENT } }]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)

	(controller $Tooltip
		(renderer ='SimpleStatusTooltip')
		(bind enabled "tabLockedReason != null")
		(args
			_text = "tr('IDS_DOCK_TAB_LOCKED_REASON_TOOLTIP_' + tabLockedReason.text)"
			_unifiedStatus = "tabLockedReason.unifiedStatus"
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)
)

(def element SecondaryTabButtonEcoboost (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.ECOBOOSTS"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.ECOBOOSTS"))

		(struct ecoBonusTabTip =		PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.ECO_BONUS_ECOBOOSTS_TAB"))
		(struct ecoBonusTabRepeatTip =	PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.ECO_BONUS_ECOBOOSTS_TAB_REPEAT"))

		(var newTipId:number = "ecoBonusTabTip.isActive			? SC.Context_guiding_tip.TIP_TYPE.ECO_BONUS_ECOBOOSTS_TAB :
								ecoBonusTabRepeatTip.isActive	? SC.Context_guiding_tip.TIP_TYPE.ECO_BONUS_ECOBOOSTS_TAB_REPEAT
																: SC.Context_guiding_tip.TIP_TYPE.NONE")


		
		(macro PULL_SHIP_ID)

		(struct tabLockedReasonNotOwned = DOCK_SECONDARY_TAB_BUTTON_LOCKED_SHIP_NOT_OWNED_REASON (_viewedShipId = "viewedShipId"))

		(var tabLockedReason:dict = "	tabLockedReasonNotOwned.isActive 	? { text: tabLockedReasonNotOwned.value,
																				unifiedStatus: tabLockedReasonNotOwned.unifiedStatus }
																			: null")
	)
	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_ECOBOOST'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.ECOBOOSTS } }]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)

	(controller $Tooltip
		(renderer ='SimpleStatusTooltip')
		(bind enabled "tabLockedReason != null")
		(args
			_text = "tr('IDS_DOCK_TAB_LOCKED_REASON_TOOLTIP_' + tabLockedReason.text)"
			_unifiedStatus = "tabLockedReason.unifiedStatus"
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)
)

(def element SecondaryTabButtonCamouflage (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.CAMOUFLAGE"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.CAMOUFLAGE"))

		(struct camoTip =				PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_DESC_1"))
		(struct camoRepeatTip =			PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_DESC_1_REPEAT"))
		(struct camoLockedTip =			PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_TAB_LOCKED"))

		(var newTipId:number = "camoTip.isActive			? SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_DESC_1 :
								camoRepeatTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_DESC_1_REPEAT :
								camoLockedTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.EXTERIOR_TAB_LOCKED
															: SC.Context_guiding_tip.TIP_TYPE.NONE")


		
		(macro PULL_SHIP_ID)

		(struct tabLockedReasonNotOwned = DOCK_SECONDARY_TAB_BUTTON_LOCKED_SHIP_NOT_OWNED_REASON (_viewedShipId = "viewedShipId"))
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_CAMOUFLAGE'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[{ type: 'inputMapping.onAction', name: 'navigateTo', args: { route: SC.Ui_windows.ROUTE.CAMOUFLAGE } }]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "newTipId")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_pointerOffset =	-18
			_noPointer =		"camoLockedTip.isActive"
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)

	(controller $Tooltip
		(renderer ='SimpleStatusTooltip')
		(bind enabled "tabLockedReasonNotOwned.isActive")
		(args
			_text =				"tr('IDS_DOCK_TAB_LOCKED_REASON_TOOLTIP_' + tabLockedReasonNotOwned.value)"
			_unifiedStatus =	"tabLockedReasonNotOwned.unifiedStatus"
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)
)

(def element SecondaryTabButtonEnsign (_sidePaddings:dict = "DOCK_TAB_PADDINGS.DEFAULT")
	(scope
		(struct routeMenuData = ROUTE_MENU_DATA(_route = "SC.Ui_windows.ROUTE.ENSIGN"))
		(struct markerData = PULL_MARKER_NEW(_groupName = "SC.Ui_common.CONTENT_MARKER_GROUPS.ENSIGN"))


		
		(macro PULL_SHIP_ID)
		(struct tabLockedReasonNotOwned = DOCK_SECONDARY_TAB_BUTTON_LOCKED_SHIP_NOT_OWNED_REASON (_viewedShipId = "viewedShipId"))

		(var tabLockedReason:dict = "	tabLockedReasonNotOwned.isActive 	? { text: tabLockedReasonNotOwned.value,
																				unifiedStatus: tabLockedReasonNotOwned.unifiedStatus }
																			: null")
	)

	(element DockSecondaryTabButton
		_label = 'IDS_SECONDARY_TAB_BUTTON_ENSIGN'
		_isEnabled = "routeMenuData.isEnabled"
		_isSelected = "routeMenuData.isActive"
		_markerType = "markerData.markerType"
		_markerNewCounter = "markerData.markerCounter"
		_methods = "[	{
							type: 'inputMapping.onAction',
							name: 'navigateTo',
							args: { route: SC.Ui_windows.ROUTE.ENSIGN }
						}]"
		_sidePaddings = "_sidePaddings"
	)

	(controller $Tooltip
		(renderer ='SimpleStatusTooltip')
		(bind enabled "tabLockedReason != null")
		(args
			_text = "tr('IDS_DOCK_TAB_LOCKED_REASON_TOOLTIP_' + tabLockedReason.text)"
			_unifiedStatus = "tabLockedReason.unifiedStatus"
		)
		(macro DEFAULT_TOOLTIP_BEHAVIOUR)
	)
)

(def element DockSecondaryTabButton (	_label:str = '',
										_isSelected:bool = false,
										_isEnabled:bool = true,
										_markerType:number = "SC.Ui_common.CONTENT_MARKER_TYPE.NONE",
										_markerNewCounter:number = 0,
										_newContentCounter:number = 0,
										_sidePaddings:dict = "{ left: SXS, right: SXS }",
										_methods:array = [])
	(scope
		(macro MOUSE_HANDLER_SCOPE)

		(var state:number = "	!_isEnabled	? SC.Ui_styles.BUTTON_STATE.DISABLED :
								_isSelected	? SC.Ui_styles.BUTTON_STATE.SELECTED :
								mouseDown	? SC.Ui_styles.BUTTON_STATE.DOWN :
								rollOver	? SC.Ui_styles.BUTTON_STATE.OVER
											: SC.Ui_styles.BUTTON_STATE.UP")
	
		(var selectionState:number = "_isEnabled		?	_isSelected				? SC.Ui_styles.BUTTON_STATE.SELECTED :
															mouseDown				? SC.Ui_styles.BUTTON_STATE.DOWN :
															rollOver				? SC.Ui_styles.BUTTON_STATE.OVER
																					: SC.Ui_styles.BUTTON_STATE.UP
														:	SC.Ui_styles.BUTTON_STATE.DISABLED")

		(var textAlpha:number = "DOCK_SECONDARY_TAB_BUTTON_LABEL_ALPHA[state]")

		(var newMarkerElement:str = "MARKER_ELEMENT[_markerType] ?: ''")
		(var isNew:bool = "_isEnabled && newMarkerElement && !_isSelected")
	)
	(style
		(height = "SECONDARY_DOCK_TAB_HEIGHT")
		(backgroundColor = "NO_COLOR")
	)

	
	(block
		(style
			(bind paddingLeft "_sidePaddings.left")
			(bind paddingRight "_sidePaddings.right")
			(height = 100%)
			(align = "middle")
		)

		(block
			(tf
				(bind name "'secondary_tab_button_label_' +_label")
				(class $TextDefaultBoldNM)
				(style
					(hitTest = false)
					(alpha = "textAlpha")
				)

				(macro DEFAULT_CONTROL_STATE_ANIMATION_ALPHA
					_trigger = "state"
					_alpha = "textAlpha"
					_duration = "0.12"
				)

				(bind text "toUpper(tr(_label))")
			)

			(block
				(macro DEFAULT_CONTROL_MARKER_ANIMATION "isNew")
				(style
					(position = "absolute")
					(top = "-SXS")
					(bind right "	_markerType == SC.Ui_common.CONTENT_MARKER_TYPE.NEW			? 20px :
									_markerType == SC.Ui_common.CONTENT_MARKER_TYPE.NEW_COUNT	? { 1280: SXS , 1920: S }
																								: { 1280: S , 1920: XXS }")
				)

				(controller $Instance
					(bind enabled "isNew")
					(bind renderer "newMarkerElement")
					(args
						_newContentCounter = "_markerNewCounter"
					)
				)
			)
		)

		(block
			(style
				(position = "absolute")
				(bottom = 0)
				(width = 100%)
			)

			(element TabSelectionStatePanel
				_state = "selectionState"
				_sideOffset = 6px
			)
		)
	)

	(block
		(class $FullsizeAbsolute)
		(style
			(backgroundColor = "NO_COLOR")
			(bind hitTest "_isEnabled && !_isSelected")
		)

		(macro MOUSE_EVENTS_DISPATCHER)
		(macro SOUND_HANDLER "'button_tab'")
		(macro MOUSE_LMB_EXTERNAL_CALL_REPEAT "_methods")
	)
)

(def element DockSecondaryImageTabButton	(	_imageUrl:str,
												_imageWidth:number = 30px,
												_imageHeight:number = 30px,
												_isSelected:bool = false,
												_isEnabled:bool = true,
												_isNewMarker:bool = false,
												_isAttentionMarker:bool = false,
												_newContentCounter:number = 0,
												_sidePaddings:dict = "{ left: SXS, right: SXS }",
												_methods:array = [],
												_data:dict = {})
	(scope
		(macro MOUSE_HANDLER_SCOPE)

		(var state:number = "	!_isEnabled	? SC.Ui_styles.BUTTON_STATE.DISABLED :
								_isSelected	? SC.Ui_styles.BUTTON_STATE.SELECTED :
								mouseDown	? SC.Ui_styles.BUTTON_STATE.DOWN :
								rollOver	? SC.Ui_styles.BUTTON_STATE.OVER
											: SC.Ui_styles.BUTTON_STATE.UP")

		(var iconAlpha:number = "DOCK_SECONDARY_TAB_BUTTON_ICON_ALPHA[state]")
	
		(var selectionState:number = "_isEnabled		?	_isSelected				? SC.Ui_styles.BUTTON_STATE.SELECTED :
															mouseDown				? SC.Ui_styles.BUTTON_STATE.DOWN :
															rollOver				? SC.Ui_styles.BUTTON_STATE.OVER
																					: SC.Ui_styles.BUTTON_STATE.UP
														:	SC.Ui_styles.BUTTON_STATE.DISABLED")

		(var nationName:str = "_data && 'nation' in _data ? _data.nation : ''")


		(struct paragonsGuidingTip = PULL_GUIDING_TIP(_type = "SC.Context_guiding_tip.TIP_TYPE.PARAGONS_DROP_NATION"))

		(var newTipId:number = "paragonsGuidingTip.isActive		? SC.Context_guiding_tip.TIP_TYPE.PARAGONS_DROP_NATION
																: SC.Context_guiding_tip.TIP_TYPE.NONE")

		(var isParagonTipVisible:bool = "!_isSelected && nationName == paragonsGuidingTip.targetId")
		(var isGuidingTipVisible:bool = "paragonsGuidingTip.isActive && isParagonTipVisible")
	)

	(style
		(height = "SECONDARY_DOCK_TAB_RESEARCH_HEIGHT")
		(backgroundColor = "NO_COLOR")
	)

	
	(block
		(style
			(bind paddingLeft "_sidePaddings.left")
			(bind paddingRight "_sidePaddings.right")
			(height = 100%)
			(align = "middle")
		)

		(block
			(block
				(style
					(bind backgroundImage "_imageUrl")
					(backgroundSize = "cover")
					(bind width "_imageWidth")
					(bind height "_imageHeight")
					(alpha = "iconAlpha")
				)

				(macro DEFAULT_CONTROL_STATE_ANIMATION_ALPHA
					_trigger = "state"
					_alpha = "iconAlpha"
					_duration = "0.12"
				)
			)
		)

		(block
			(style
				(position = "absolute")
				(bottom = 0)
				(width = 100%)
			)

			(element TabSelectionStatePanel
				_state = "selectionState"
				_sideOffset = 6px
			)
		)
	)

	(block
		(class $FullsizeAbsolute)
		(style
			(backgroundColor = "NO_COLOR")
			(bind hitTest "_isEnabled && !_isSelected")
		)

		(macro MOUSE_EVENTS_DISPATCHER)
		(macro SOUND_HANDLER "'button_tab'")
		(macro MOUSE_LMB_EXTERNAL_CALL_REPEAT "_methods")
	)

	(controller $Instance renderer='GuidingTipHub'
		(bind enabled "isGuidingTipVisible")
		(args
			_tipId =			"newTipId"
			_tipPositioning =	"TIP_POSITION_BOTTOM"
			_offsetY =			"XS"
			_pointerOffset =	"-MS"
			_modalWindowName =	"SC.Ui_windows.WINDOWS.DOCK"
		)
	)
)

(def constant DOCK_SECONDARY_TAB_SELECTION_PANEL_STATE "{
	SC.Ui_styles.BUTTON_STATE.SELECTED:				{	visualScaleY: 1,
														colorTransform:	{	redMultiplier:0, greenMultiplier:0, blueMultiplier:0, alphaMultiplier: 1,
																			redOffset: 76,	greenOffset: 214,	blueOffset: 232 }},
	SC.Ui_styles.BUTTON_STATE.DOWN:					{	visualScaleY: 1,
														colorTransform:	{	redMultiplier:0, greenMultiplier:0, blueMultiplier:0, alphaMultiplier: 1,
																			redOffset: 180,	greenOffset: 180,	blueOffset: 180 }},
	SC.Ui_styles.BUTTON_STATE.OVER:					{	visualScaleY: 1,
														colorTransform:	{	redMultiplier:0, greenMultiplier:0, blueMultiplier:0, alphaMultiplier: 1, 
																			redOffset: 230,	greenOffset: 230,	blueOffset: 230 }},
	SC.Ui_styles.BUTTON_STATE.UP:					{	visualScaleY: 0,
														colorTransform:	{	redMultiplier:0, greenMultiplier:0, blueMultiplier:0, alphaMultiplier: 0, 
																			redOffset: 230,	greenOffset: 230,	blueOffset: 230 }},
	SC.Ui_styles.BUTTON_STATE.DISABLED:				{	visualScaleY: 0,
														colorTransform:	{	redMultiplier:0, greenMultiplier:0, blueMultiplier:0, alphaMultiplier: 1,
																			redOffset: 140,	greenOffset: 140,	blueOffset: 140 }}
}")

(def element TabSelectionStatePanel (_state:number = "SC.Ui_styles.BUTTON_STATE.UP", _sideOffset:number = 0)
	(style
		(width = 100%)
		(height = 4px)
		(backgroundColor = "NO_COLOR")
		(align = "center|bottom")
		(bind paddingLeft "-(_sideOffset)")
		(bind paddingRight "-(_sideOffset)")
	)

	(block
		(style
			(width = 100%)
			(height = 2px)
			(backgroundColor = "SC.Ui_styles.SERVICE_COLORS.WHITE")

			(visualScaleY = "DOCK_SECONDARY_TAB_SELECTION_PANEL_STATE[_state].visualScaleY")
			(pivotY = 100%)
		)
		(colorTransform = "DOCK_SECONDARY_TAB_SELECTION_PANEL_STATE[_state].colorTransform")

		(controller $Animation
			(bindcall play
				duration = 0.12
				to = "DOCK_SECONDARY_TAB_SELECTION_PANEL_STATE[_state]"
				easing = "Easing.line"
				action = "kill"
				watch = false
				(bind trigger "_state")
			)
		)
	)
)

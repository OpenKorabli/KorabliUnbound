(def element ModalClanSeasonEnds ()
	(macro MODAL_WINDOW_INIT)
	(macro MODAL_WINDOW_BG)
	(scope
		(struct stageSize = STAGE_SIZE())
		(var isLowDimension:bool = "stageSize.height <= 800")
		(var stageScale:number = "isLowDimension ? 0.7 : 1")

		(struct selfPlayer = PULL_SELF_PLAYER())
		(var clanId:number = "selfPlayer.entity.clanman.clanId ?: 0" (event "selfPlayer.entity.clanman.evClanIdChanged"))

		(struct clanInfo = PULL_CLANINFO(_clanId="clanId"))
		(var clanTagName:str = "'[' + clanInfo.tag + ']'")

		(var clanSquadLadderInfoEntity:dhEntity = "getPrimaryEntity(CC.clanSquadLadderInfo, clanId)")
		(var clanSquadLadderInfo:dhComponent = "clanSquadLadderInfoEntity.clanSquadLadderInfo")
		(var rating:number = "clanSquadLadderInfo.rating ?: 0")
		(var divisionId:number = "clanSquadLadderInfo.divisionId ?: 0")
		(var leagueId:number = "clanSquadLadderInfo.leagueId ?: 0")
	)
	(name = 'ModalClanSeasonEnds')

	(style (align = "center"))

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
		(style
			(width = 100%)
			(marginBottom = "{720:M, 10820:L}")
		)

		(element ModalWindowHeaderFullSize
			_windowName = 'IDS_CLAN_BATTLES_SEASON_RESULT_HEADER'
			_paddingRight = "M"
			_paddingLeft = "M"
			_backButtonText = 'IDS_RETURN_FROM_MODAL_WINDOW_BUTTON'
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 2)
		(style (marginBottom = "{720:S, 10820:L}"))
		(tf
			(class $TextDefaultBold36NM)
			(style
				(marginBottom = "M")
				(alpha = "TA")
			)
			(bind text "clanTagName")
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 2.5)
		(style (marginBottom = "{720:S, 10820:L}"))
		(tf
			(class $TextDefaultBold36NM)
			(style
				(marginBottom = "M")
				(alpha = "TA")
			)
			(text = 'IDS_CLAN_BATTLES_SEASON_END')
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)
		(style
			(width = 512px)
			(height = 512px)
			(bind scaleX "stageScale")
			(bind scaleY "stageScale")
		)
		(element ClanLeagueLogoTemplate
			_hasEmblemTooltip = false
			_isStarVisible = false
			_areDivisionDotsVisible = true
			_leagueId = "leagueId"
			_rating = "rating"
			_toDivisionId = "divisionId"
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 4)
		(tf
			(class $TextDefault26NM)
			(style
				(marginTop = "M")
				(marginBottom = "M")
				(alpha = "TA")
			)
			(text = 'IDS_REWARD_FOR_CLAN_BATTLE')
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 4.5)
		(style
			(width = 94px)
			(height = 86px)
			(marginBottom = "{720:M, 1080:L}")
			(backgroundImage = 'url:../service_kit/giftbox/giftbox.png')
		)

		(block
			(style
				(position = "absolute")
				(left = -13px)
				(top = 30px)
			)
			(element IssuedStampBig
				_text = "toUpper(tr('IDS_ISSUED_STAMP'))"
				_angleRotation = -5
				_alpha = 0.8
			)
		)
	)

	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 5)
		(element DefaultButton
			_width = 139px
			_label = 'IDS_CLOSE_UPPER_CASE'
			_focusIndex = 3
			_name = 'btn_cancel'
		)
	)
)
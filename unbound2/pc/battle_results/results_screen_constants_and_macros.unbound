(def constant BATTLE_RESULT_LAYOUT_RENDERER "[
	'PersonalResultSection',
	'TeamResultSection',
	'DetailedReportSection',
	'EconomicsSection'
]")



(def constant RESULT_TITLE_COLOR "{
	POSITIVE:		SC.Ui_styles.SERVICE_COLORS.GREEN,
	NEGATIVE:		SC.Ui_styles.SERVICE_COLORS.RED,
	DEFAULT:		SC.Ui_styles.SERVICE_COLORS.GRAY
}")

(def constant RESULT_SCREEN_ROW_FONT_COLOR "{
	SC.Result_screen.COLORS.PINK:		SC.Ui_styles.SERVICE_COLORS.PINK,
	SC.Result_screen.COLORS.RED:		SC.Ui_styles.SERVICE_COLORS.RED,
	SC.Result_screen.COLORS.GREY:		SC.Ui_styles.SERVICE_COLORS.WHITE
}")

(def constant RESULT_TITLE_IDS "{
	SC.Battle.BATTLE_RESULT.DEFEAT:					'IDS_DEFEAT',
	SC.Battle.BATTLE_RESULT.VICTORY:				'IDS_VICTORY',
	SC.Battle.BATTLE_RESULT.DRAW:					'IDS_DRAW',
	SC.Battle.BATTLE_RESULT.FIRST_BATTLE_LOST:		'IDS_BATTLE_FINISHED',
	SC.Battle.BATTLE_RESULT.SUCCESS:				'IDS_SUCCESS',
	SC.Battle.BATTLE_RESULT.FAILURE:				'IDS_FAILURE',
	SC.Battle.BATTLE_RESULT.PORTAL:					'IDS_BATTLE_FINISHED',
	SC.Battle.BATTLE_RESULT.MATCH:					'IDS_BATTLE_FINISHED',
	SC.Battle.BATTLE_RESULT.DEATH:					'IDS_BATTLE_FINISHED',
	SC.Battle.BATTLE_RESULT.TEAM_LADDER_WINNER:		'IDS_VICTORY',
	SC.Battle.BATTLE_RESULT.TEAM_LADDER_LOSER:		'IDS_BATTLE_FINISHED'
}")



(def constant PBS_COLUMN_DIVISIONS_WIDTH 40px)
(def constant PBS_COLUMN_NICKNAME_WIDTH 161px)
(def constant PBS_COLUMN_SHIP_WIDTH 200px)
(def constant PBS_COLUMN_FRAGS_WIDTH 40px)
(def constant PBS_COLUMN_PLANE_FRAGS_WIDTH 40px)
(def constant PBS_COLUMN_EXP_WIDTH 62px)
(def constant PBS_COLUMN_ACHIEVEMENTS_WIDTH 40px)
(def constant PBS_COLUMN_EMOJI_WIDTH 52px)


(def constant PBS_SHIP_CAROUSEL_ITEM_WIDTH 208px)
(def constant PBS_SHIP_CAROUSEL_ITEM_HEIGHT 108px)
(def constant PBS_BUILDING_CAROUSEL_ITEM_WIDTH 198px)
(def constant PBS_BUILDING_CAROUSEL_ITEM_HEIGHT 124px)


(def constant DEATH_REASON_NONE 0)



(def constant BATTLE_STATS_DETAILED_REPORT_ROW_ITEM_TOOLTIP "{
	SC.Result_screen.TOOLTIP_TYPES.TEAM_KILLER:				'AbuseStatusProfileTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_ARTILLERY:			'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_TORPEDOES:			'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_BOMBS:				'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_ROCKETS:			'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_SKIP_BOMBS:		'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_AIRSUPPORT:		'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_NAVAL_MINES:		'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_DEPTH_CHARGES:		'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.SCOUTING_DAMAGE:			'TakenDamageTooltip',
	SC.Result_screen.TOOLTIP_TYPES.TAKEN_OTHER:				'TakenDamageTooltip'
}")

(def constant BATTLE_STATS_DETAILED_REPORT_ROW_RENDERER "{
	SC.Result_screen.TYPES.HEADER:							'BattleStatsDetailedReportHeader',
	SC.Result_screen.TYPES.SUBHEADER:						'BattleStatsDetailedReportSubHeader',
	SC.Result_screen.TYPES.LINE:							'BattleStatsDetailedReportLine',
	SC.Result_screen.TYPES.SUBLINE:							'BattleStatsDetailedReportSubLine',
	SC.Result_screen.TYPES.LIST:							'BattleStatsDetailedReportList',
	SC.Result_screen.TYPES.TOTAL:							'BattleStatsDetailedReportTotalLine',
	SC.Result_screen.TYPES.PLAIN_LINE:						'BattleStatsDetailedReportPlainLine'
}")

(def constant BATTLE_STATS_DETAILED_REPORT_ROW_VALUE_RENDERER "{
	SC.Result_screen.FORMAT.TIME:			'BattleStatsDetailedReportRowTimeValue',
	SC.Result_screen.FORMAT.PERIOD:			'BattleStatsDetailedReportRowPeriodValue',
	SC.Result_screen.FORMAT.DISTANCE:		'BattleStatsDetailedReportRowDistanceValue',
	SC.Result_screen.FORMAT.BOLD:			'BattleStatsDetailedReportRowBoldValue',
	SC.Result_screen.FORMAT.FLOAT:			'BattleStatsDetailedReportRowFloatValue',
	SC.Result_screen.FORMAT.INTEGER:		'BattleStatsDetailedReportRowIntegerValue',
	SC.Result_screen.FORMAT.NO_VALUE:		''
}")

(def constant BATTLE_RESULTS_ICON_STATS "{
	KILL:				'icon_stat_kill',
	DAMAGE:				'icon_stat_damage',
	BUILDING_KILL:		'icon_stat_building_kill',
	PLANE:				'icon_stat_plane',
	SUPPRESSION:		'icon_stat_suppression'
}")

(def constant BATTLE_RESULTS_MODULE_ICON_LIST "[
	'engine_crit',
	'main_caliber_crit',
	'atba_gun_crit',
	'aviation_crit',
	'air_defence_crit',
	'',
	'torpedo_tube_crit',
	'path_control_crit',
	'depth_charge_gun_crit',
	'',
	'',
	'',
	'',
	'',
	'pinger_crit'
]")

(def constant BATTLE_RESULTS_BUILDING_ICON_WITH_STATUS "{
	'Complex_N':			{ image: 'icon_ground_artillery_neutral',		width: 11px,	height: 15px },
	'SensorTower_N':		{ image: 'icon_ground_radar_neutral',			width: 13px,	height: 15px },
	'AntiAircraft_N':		{ image: 'icon_ground_air_defence_neutral',		width: 13px,	height: 17px },
	'Military_N':			{ image: 'icon_ground_supply_neutral',			width: 11px,	height: 11px },
	'Complex_D':			{ image: 'icon_ground_artillery_dead',			width: 13px,	height: 15px },
	'SensorTower_D':		{ image: 'icon_ground_radar_dead',				width: 13px,	height: 15px },
	'AntiAircraft_D':		{ image: 'icon_ground_air_defence_dead',		width: 13px,	height: 17px },
	'Military_D':			{ image: 'icon_ground_supply_dead',				width: 13px,	height: 11px },
	'CoastalArtillery_N':	{ image: 'icon_ground_artillery_neutral',		width: 11px,	height: 15px },
	'CoastalArtillery_D':	{ image: 'icon_ground_artillery_dead',			width: 13px,	height: 15px },
	'AirBase_N':			{ image: 'icon_ground_airbase_neutral',			width: 17px,	height: 17px },
	'AirBase_D':			{ image: 'icon_ground_airbase_dead',			width: 23px,	height: 23px },
	'SpaceStation_N':		{ image: 'icon_ground_station_neutral',			width: 21px,	height: 20px },
	'SpaceStation_D':		{ image: 'icon_ground_station_dead',			width: 21px,	height: 20px },
	'Generator_N':			{ image: 'icon_ground_generator_neutral',		width: 11px,	height: 13px },
	'Generator_D':			{ image: 'icon_ground_generator_dead',			width: 11px,	height: 13px }
}")

(def constant BATTLE_RESULTS_SHIP_INTERACTIONS_TOOLTIP_ROW_RENDERER "{
	SC.Result_screen.TYPES.BUILDING_TOOLTIP_HEADER:				'ShipInteractionsBuildingTooltipHeader',
	SC.Result_screen.TYPES.TOOLTIP_HEADER:						'ShipInteractionsTooltipHeader',
	SC.Result_screen.TYPES.HEADER:								'ShipInteractionsHeader',
	SC.Result_screen.TYPES.LINE:								'ShipInteractionsLine',
	SC.Result_screen.TYPES.SUBLINE:								'ShipInteractionsSubLine',
	SC.Result_screen.TYPES.LIST:								'BattleStatsDetailedReportList',
	SC.Result_screen.TYPES.EMPTY_LINE:							'ShipInteractionsTooltipEmptyLine',
	SC.Result_screen.TYPES.PLAYER:								'ShipInteractionsPlayer',
	SC.Result_screen.TYPES.TOOLTIP_LINE:						'ShipInteractionsTooltipLine'
}")



(def constant BATTLE_STATS_ECONOMICS_ROW_RENDERER "{
	SC.Result_screen.TYPES.HEADER:					'BattleStatsEconomicsHeader',
	SC.Result_screen.TYPES.SUBHEADER:				'BattleStatsEconomicsSubHeader',
	SC.Result_screen.TYPES.LINE:					'BattleStatsEconomicsLine',
	SC.Result_screen.TYPES.SUBLINE:					'BattleStatsEconomicsSubLine',
	SC.Result_screen.TYPES.LIST:					'BattleStatsEconomicsList',
	SC.Result_screen.TYPES.TOTAL:					'BattleStatsEconomicsTotal',
	SC.Result_screen.TYPES.EXP_WITH_PROGRESS:		'BattleStatsEconomicsExpWithProgress',
	SC.Result_screen.TYPES.TOOLTIP_LINE:			'BattleStatsEconomicsTooltipLine',
	SC.Result_screen.TYPES.EMPTY_LINE:				'BattleStatsEconomicsEmptyLine'
}")

(def constant BATTLE_STATS_ECONOMICS_ROW_VALUE_RENDERER "{
	SC.Result_screen.FORMAT.CREDITS:						'BattleStatsEconomicsRowCredits',
	SC.Result_screen.FORMAT.CREDITS_APPLIED:				'BattleStatsEconomicsRowCreditsApplied',
	SC.Result_screen.FORMAT.CREDITS_APPLIED_SHOW_ZERO:		'BattleStatsEconomicsRowCreditsAppliedShowZero',
	SC.Result_screen.FORMAT.GOLD:							'BattleStatsEconomicsRowGold',
	SC.Result_screen.FORMAT.GOLD_APPLIED:					'BattleStatsEconomicsRowGoldApplied',
	SC.Result_screen.FORMAT.GOLD_RIGHT:						'BattleStatsEconomicsRowGoldRight',
	SC.Result_screen.FORMAT.CREDITS_ZERO_HIDE:				'BattleStatsEconomicsRowCreditsHideZero',
	SC.Result_screen.FORMAT.EXP:							'BattleStatsEconomicsRowExp',
	SC.Result_screen.FORMAT.FREE_XP:						'BattleStatsEconomicsRowFreeXP',
	SC.Result_screen.FORMAT.FREE_XP_RIGHT:					'BattleStatsEconomicsRowFreeXPRight',
	SC.Result_screen.FORMAT.CREW_XP:						'BattleStatsEconomicsRowCrewXP',
	SC.Result_screen.FORMAT.PERCENTS:						'BattleStatsEconomicsRowPercents',
	SC.Result_screen.FORMAT.TOOLTIP_PERCENTS:				'BattleStatsEconomicsRowTooltipPercents',
	SC.Result_screen.FORMAT.ELITE_XP:						'BattleStatsEconomicsRowEliteXP'
}")

(def constant BATTLE_STATS_ECONOMICS_ROW_VALUE_NO_RENDERER_LIST "[
	SC.Result_screen.FORMAT.SKILL_POINTS,
	SC.Result_screen.FORMAT.AOGAS,
	SC.Result_screen.FORMAT.WARNING_ICON,
	SC.Result_screen.FORMAT.NO_VALUE
]")

(def constant BATTLE_STATS_ECONOMICS_ROW_DICT_OF_VALUES_LIST "[
	SC.Result_screen.FORMAT.CREDITS_APPLIED,
	SC.Result_screen.FORMAT.CREDITS_APPLIED_SHOW_ZERO,
	SC.Result_screen.FORMAT.GOLD_APPLIED
]")

(def constant BATTLE_STATS_ECONOMICS_ROW_ITEM_TOOLTIP_RENDERER "{
	SC.Result_screen.TOOLTIP_TYPES.ECOBOOSTS:				'EcoboostPostBattleTooltip',
	SC.Result_screen.TOOLTIP_TYPES.SSE:						'PostBattleSSEQuestTooltip',
	SC.Result_screen.TOOLTIP_TYPES.RECAMO:					'PostBattleRecamoTooltip',
	SC.Result_screen.TOOLTIP_TYPES.REBOOST:					'PostBattleReboostTooltip',
	SC.Result_screen.TOOLTIP_TYPES.RESIGNAL:				'PostBattleResignalTooltip',
	SC.Result_screen.TOOLTIP_TYPES.WAFFENTRAGER_BOOSTER:	'WaffentragerBoosterTooltip'
}")



(def struct GET_BATTLE_RESULTS_SCOPE ()
	(var battleResultsEntity:dhEntity =				"getSingleEntity(CC.battleResultsStructured)")
	(var battleResultsDataComponent:dhComponent =	"battleResultsEntity.dataComponent")
	(var battleResultsData:dict =					"battleResultsDataComponent.data ?: {}"	(event "battleResultsDataComponent.evDataChanged"))

	(var gameData:dict =		"battleResultsData.game_data")

	(var isSpectator:bool =		"gameData.isSpectator")
	(var gameMode:number =		"gameData.game_mode")
	(var scenario:str =			"gameData.scenario")
	(var battleType:str =		"gameData.battleType")

	(var isPersonalResultsOnly:bool =	"scenario == SC.Common.FIRST_BATTLE_INFO.FIRST_BATTLE")
	(var isTeamResultVisible:bool =		"gameMode != SC.Battle.GAME_MODE.BATTLE_CHALLENGES && gameMode != SC.Battle.GAME_MODE.BATTLE_TRIALS")
	(var isDetailedReportVisible:bool =	"gameMode != SC.Battle.GAME_MODE.BATTLE_CHALLENGES")

	(var areTabsHidden:bool =			"isSpectator || isPersonalResultsOnly")
)


(def macro PBS_LOADING_ANIMATION_SCOPE ()
	(event evShowFast)
	(event evStatsLoaded)

	(var loaded:bool = false)
	(bind loaded "true" init=false (event "evStatsLoaded"))
)

(def macro PBS_LOADING_ANIMATION ()
	(dispatch evShowFast	dir="EventDirection.UP"	on='addedToStage'	(bind enabled "loaded"))
	(dispatch evStatsLoaded	dir="EventDirection.UP"	on='addedToStage'	(bind enabled "!loaded"))

	(style
		(alpha = 0)
		(visualOffsetY = 10px)
	)

	(controller $Animation
		(bindcall play
			from =		"{ alpha: 0, visualOffsetY: 10px }"
			to =		"{ alpha: 1, visualOffsetY: 0px }"
			duration =	0.15
			delay =		0.1
			easing =	"Easing.line"
			action =	"kill"
			(event "evShowFast")
		)
		(bindcall play
			from =		"{ alpha: 0, visualOffsetY: 10px }"
			to =		"{ alpha: 1, visualOffsetY: 0px }"
			duration =	0.15
			delay =		0.4
			easing =	"Easing.line"
			action =	"kill"
			(event "evStatsLoaded")
		)
	)
)


(def macro PBS_BLOCK_SHOW_ANIMATION (	_showFromData:expression =	"{ alpha: 0, visualOffsetY: 10px }",
										_showToData:expression =	"{ alpha: 1, visualOffsetY: 0px }",
										_showDuration:expression =	"0.15",
										_showDelay:expression =		"0")
	(controller $Animation
		(bindcall play
			from =		"_showFromData"
			to =		"_showToData"
			duration =	"_showDuration"
			delay =		"_showDelay"
			easing =	"Easing.quad_out"
			action =	"kill"
			(event "startShow")
		)
	)
)

(def macro PBS_BLOCK_HIDE_ANIMATION (	_hideFromData:expression =	"{ alpha: 1, visualOffsetY: 0px }",
										_hideToData:expression =	"{ alpha: 0, visualOffsetY: -10px }",
										_hideDuration:expression =	"0.15",
										_hideDelay:expression =		"0")
	(controller $Animation
		(bindcall play
			from =		"_hideFromData"
			to =		"_hideToData"
			duration =	"_hideDuration"
			delay =		"_hideDelay"
			easing =	"Easing.quad_in"
			action =	"kill"
			(event "startHide")
		)
	)
)

(def macro PBS_BLOCK_SHOW_HIDE_ANIMATION (	_showFromData:expression =	"{ alpha: 0, visualOffsetY: 10px }",
											_showToData:expression =	"{ alpha: 1, visualOffsetY: 0px }",
											_hideFromData:expression =	"{ alpha: 1, visualOffsetY: 0px }",
											_hideToData:expression =	"{ alpha: 0, visualOffsetY: -10px }",
											_showDuration:expression =	"0.15",
											_showDelay:expression =		"0",
											_hideDuration:expression =	"0.15",
											_hideDelay:expression =		"0")
	(controller $Animation
		(bindcall play
			from =		"_showFromData"
			to =		"_showToData"
			duration =	"_showDuration"
			delay =		"_showDelay"
			easing =	"Easing.quad_out"
			action =	"kill"
			(event "startShow")
		)
		(bindcall play
			from =		"_hideFromData"
			to =		"_hideToData"
			duration =	"_hideDuration"
			delay =		"_hideDelay"
			easing =	"Easing.quad_in"
			action =	"kill"
			(event "startHide")
		)
	)
)


(def constant PBS_ELEMENT_BASE_ANIM_DELAY 1.6)

(def macro PBS_ELEMENTS_ANIMATION (_isEnabled:expression = "true", _delay:expression = "0")
	(style
		(alpha = "_isEnabled ? 0 : 1")
		(visualOffsetY = "_isEnabled ? 10px : 0px")
		(hitTest = "_isEnabled ? false : true")
	)

	(controller $Animation
		(bindcall play	delay =		"PBS_ELEMENT_BASE_ANIM_DELAY + _delay"
						duration =	"DEFAULT_CONTENT_ANIM.DURATIONS.APPEAR"
						from =		"{ alpha: 0, visualOffsetY: 10px, hitTest: false }"
						to =		"{ alpha: 1, visualOffsetY: 0px, hitTest: true }"
						easing =	"Easing.quad_out"
						action =	"kill"
						on =		'addedToStage'
						(bind enabled "_isEnabled")
						(event "startShow")
		)
	)
)


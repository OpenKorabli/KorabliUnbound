(def constant BALANCER_COLOR {
	GREEN:	{	redMultiplier:		0,
				greenMultiplier:	0.75,
				blueMultiplier:		0.7,
				alphaMultiplier:	1,
				redOffset:			-80,
				greenOffset:		0,
				blueOffset:			-80,
				alphaOffset:		0 },

	RED:	{	redMultiplier:		1,
				greenMultiplier:	0.12,
				blueMultiplier:		0.05,
				alphaMultiplier:	1,
				redOffset:			0,
				greenOffset:		-30,
				blueOffset:			-20,
				alphaOffset:		0 },

	BLUE:	{	redMultiplier:		0.1,
				greenMultiplier:	0.7,
				blueMultiplier:		0.9,
				alphaMultiplier:	1,
				redOffset:			0,
				greenOffset:		0,
				blueOffset:			0,
				alphaOffset:		0 },

	VIOLET:	{	redMultiplier:		0.85,
				greenMultiplier:	0.5,
				blueMultiplier:		1,
				alphaMultiplier:	1,
				redOffset:			-80,
				greenOffset:		-80,
				blueOffset:			-80,
				alphaOffset:		0 },

	ORANGE:	{	redMultiplier:		1.15,
				greenMultiplier:	0.45,
				blueMultiplier:		0.03,
				alphaMultiplier:	1,
				redOffset:			0,
				greenOffset:		-40,
				blueOffset:			-60,
				alphaOffset:		100 }
})

(def constant BATTLE_COLOR "{
	SC.Common.BATTLE_TYPES.RANDOM_BATTLE: 		BALANCER_COLOR.RED,
	SC.Common.BATTLE_TYPES.CLAN_BATTLE: 		BALANCER_COLOR.RED,

	SC.Common.BATTLE_TYPES.RANKED_BATTLE: 		BALANCER_COLOR.ORANGE,
	SC.Common.BATTLE_TYPES.RATING_BATTLE:  		BALANCER_COLOR.ORANGE,

	SC.Common.BATTLE_TYPES.TOURNAMENT_BATTLE: 	BALANCER_COLOR.BLUE,
	SC.Common.BATTLE_TYPES.TRAINING_BATTLE: 	BALANCER_COLOR.BLUE,

	SC.Common.BATTLE_TYPES.COOPERATIVE_BATTLE: 	BALANCER_COLOR.GREEN,

	SC.Common.BATTLE_TYPES.EVENT_BATTLE: 		BALANCER_COLOR.VIOLET,
	SC.Common.BATTLE_TYPES.BRAWL_BATTLE: 		BALANCER_COLOR.VIOLET
}")

(def constant BALANCER_TIMETOWAIT_WIDTH 68px)
(def constant BALANCER_BATTLE_IMAGE_SIZE 40px)
(def constant BALANCER_TOP 5px)
(def constant BALANCER_PADDING_LEFT_RIGHT "SXS")
(def constant BALANCER_SIZE {
	COLLAPSED 	: {	width: 120px,
					height: 50px },
	FULL 		: { width: 280px }
})

(def element ShipTypeCounter(_shipType:str)
	(scope
		(var balancerInfoComponent:dhComponent = "getSingleComponent(CC.balancerInfo)")

		(var aircarrierNum:number =	"balancerInfoComponent.carrierNum" 		(event "balancerInfoComponent.evCarrierNumChanged"))
		(var battleshipNum:number = "balancerInfoComponent.battleshipNum" 	(event "balancerInfoComponent.evBattleshipNumChanged"))
		(var cruiserNum:number = 	"balancerInfoComponent.cruiserNum" 		(event "balancerInfoComponent.evCruiserNumChanged"))
		(var destroyerNum:number = 	"balancerInfoComponent.destroyerNum" 	(event "balancerInfoComponent.evDestroyerNumChanged"))
		(var submarineNum:number = 	"balancerInfoComponent.submarineNum" 	(event "balancerInfoComponent.evSubmarineNumChanged"))
		
		(var count:number = "	_shipType == SC.Common.SHIP_TYPE.AIRCARRIER	? aircarrierNum :
								_shipType == SC.Common.SHIP_TYPE.BATTLESHIP	? battleshipNum :
								_shipType == SC.Common.SHIP_TYPE.CRUISER	? cruiserNum :
								_shipType == SC.Common.SHIP_TYPE.DESTROYER	? destroyerNum
																			: submarineNum")
		
		(var hasCount:bool = "count != 0")
	)
	(style 
		(align = "center")
		(width = 32px)
	)

	(element ShipIcon
		_shipType = "_shipType"
	)

	(tf
		(bind name "'ship_type_counter_' + _shipType")
		(class $TextDefaultBold18NM)
		(style (alpha = "TC"))
		(bind text "hasCount ? count : '-'")
	)
)

(def struct BALANCER_HEADER_DATA ()
	(var selectedBattleTypeEntity:dhEntity = "getSingleEntity(CC.battleType, 'selected')")
	(var battleTypeComponent:dhComponent = 	"selectedBattleTypeEntity.battleType")
	(var selectedEventBattleName:str = 		"selectedBattleTypeEntity.eventBattleState.name")

	(var battleTypeGameParamId:number = "battleTypeComponent.battleTypeGameParamId ?: 0")
	(var battleType:str = 				"battleTypeComponent.type" (event "battleTypeComponent.evBattleTypeChanged"))

	(var isEventBattle:bool = 		"battleType == SC.Common.BATTLE_TYPES.EVENT_BATTLE")
	(var isClanBattle:bool = 		"battleType == SC.Common.BATTLE_TYPES.CLAN_BATTLE")

	(var operationEntity:dhEntity = "getPrimaryEntity(CC.operation, battleTypeGameParamId)")
	(var operationComponent:dhComponent = "operationEntity.operation")
	(var pveOperationCustomIconName:str = "operationComponent.customIconName ?: ''" (event "operationComponent.evStatusChanged"))

	(var battleName:str= "isEventBattle ? selectedEventBattleName : battleType")
	(var battleTypeIcon:str = "pveOperationCustomIconName ? pveOperationCustomIconName : battleName")

	(var isShipTrialsBattle:bool = "pveOperationCustomIconName == 'TRIAL'")

	(var balancerInfoComponent:dhComponent = "getSingleComponent(CC.balancerInfo)")

	
	(var battleTypeUrl:str = "'url:../service_kit/battle_types/' + battleTypeIcon + '_small.png'")

	(var colorAnimatedBackground:dict = "	isShipTrialsBattle 		? 	BALANCER_COLOR.BLUE :
											operationEntity != null	? 	BALANCER_COLOR.GREEN : 
																		BATTLE_COLOR[battleType]")

	(var timeToWait:str = "balancerInfoComponent.timeToWait" (event "balancerInfoComponent.evTimeToWaitChanged"))
)

(def element UpperSlidingBalancer ()
	(scope
		(event evRollOver)
		(event evRollOut)
		(event evDisplayTimeOfTheElementHasEnded)
		(event evTimeOfTheFirstShowIsOver)

		(struct highContrast = HIGH_CONTRAST_INFO())

		(struct balancerHeaderData = BALANCER_HEADER_DATA())

		(var selfPlayerEntity:dhEntity = "getSingleEntity(CC.accountSelf)")
		(var preBattleSelfPlayerSimpleComponent:dhComponent ="selfPlayerEntity.preBattlePlayerSimple")
		(var isCommander:bool =	"preBattleSelfPlayerSimpleComponent.isCommander" (event "preBattleSelfPlayerSimpleComponent.evIsCommanderChanged"))
		(var isInDivision:bool = "preBattleSelfPlayerSimpleComponent != null")
		(var isButtonLeaveBattleVisible:bool = "!isInDivision || (isInDivision && isCommander)")


		(var playerShipId:number =			"balancerHeaderData.balancerInfoComponent.playerShipId")
		(var averageQueueWaitingTime:str =	"balancerHeaderData.balancerInfoComponent.averageQueueWaitingTimeString" (event "balancerHeaderData.balancerInfoComponent.evAverageQueueWaitingTimeStringChanged"))


		(var restrictionEntityId:number = "balancerHeaderData.battleTypeComponent.restrictionEntityId" (event "balancerHeaderData.battleTypeComponent.evBattleTypeChanged"))
		(var restrictionsEntity:dhEntity = "getEntity(restrictionEntityId)")
		(var restrictionsComponentId:str = "restrictionsEntity.shipListRestrictions.id" (event "restrictionsEntity.shipListRestrictions.evUpdate"))
		(var shipTypeFilters:dhCollection = "getCollectionByPath(CC.shipFilterItem, restrictionsComponentId + SC.Ui_common.SHIP_FILTER_TYPE_POSTFIX.TYPE)")
		(var shipTypesAll:dhCollection = "getCollectionByPath(CC.shipFilterItem, 'byFilterType.shipType')")
		(var shipTypeCount:number = "shipTypeFilters.length ?: shipTypesAll.length")


		(var accountLevelComponent:dhComponent = "getSingleComponent(CC.accountLevel)")
		(var curAccountLevel:number = "accountLevelComponent.level" (event "accountLevelComponent.evLevelChanged"))
		(var isShowShipCounters:bool = "!balancerHeaderData.isClanBattle && curAccountLevel >= SC.Common.ACCOUNT_LEVEL.WEB_STORAGE")


		(struct currentTopWindow = CURRENT_TOP_WINDOW())
		(var dockDataEntity:dhEntity = "getSingleEntity(CC.dockData)")
		(var dockData:dhComponent = "dockDataEntity.dockData")
		(var isDockUIHidden:bool = "dockData.isDockUIHidden" (event "dockData.evIsDockUIHiddenChanged"))
		(var isInDock:bool = "currentTopWindow.mainWindow == SC.Ui_windows.WINDOWS.DOCK")
		(struct shipPreviewRoute = 	PULL_ROUTE(_id = "SC.Ui_windows.ROUTE.SHIP_PREVIEW"))
		(var isBalancerModal:bool = "	!isInDock ||
										isInDock && isDockUIHidden ||
										shipPreviewRoute.isActive")

		(var isTimeOfTheFirstShow:bool = true)
		(bind isTimeOfTheFirstShow "false" init=false (event "evTimeOfTheFirstShowIsOver"))
		(var isRollOver:bool = "$event.isOver ?: false" watch=false (event "evRollOver") (event "evRollOut"))

		
		(var isBalancerShows:bool = "isTimeOfTheFirstShow ? true : isRollOver")
		
		(var isBalancerHideAnimationFinished:bool = "true")
		(bind isBalancerHideAnimationFinished "isBalancerShows" init=false watch=false (event "evDisplayTimeOfTheElementHasEnded"))
		(bind isBalancerHideAnimationFinished "true" init=false (bind enabled "isBalancerShows"))
	)
	(name = 'upper_sliding_balancer')

	(dispatch evTimeOfTheFirstShowIsOver delay=1.5 on='addedToStage')

	
	(dispatch evDisplayTimeOfTheElementHasEnded delay=0.285 reset=true (bind enabled "!isBalancerShows") (bind trigger "isBalancerShows"))
	(bindcall externalCall 'direct.action' "['setSessionPref', {prefName: 'BalancerHideAnimationFinished', newValue: isBalancerHideAnimationFinished}]" init=true)

	(style
		(align = "center")
		(width = 100%)
	)

	
	(block
		(bind visible "isBalancerModal")
		(class $MiddleAlignedAbsolutely)
		(style
			(width = "BALANCER_SIZE.FULL.width")
			(height = 16px)
			(backgroundColor = "NO_COLOR")
		)
		(dispatch evRollOver args="{ isOver: true }" on='rollOver')
	)

	(block
		(class $MiddleAlignedAbsolutely)
		(style
			(hitTest = false)
			(width = 1920px)
			(height = 8px)
			(backgroundImage = 'url:../animations/spine/matchmaker/matchmakerModal/matchmakerModal.skel')
			(alpha = "isBalancerModal ? 1 : 0")
		)

		(colorTransform = "balancerHeaderData.colorAnimatedBackground")
		(controller $Spine)

		(controller $Animation
			(bindcall play
				id='ubBalancerModalAlphaAnimation'
				to="{alpha: isBalancerModal ? 1 : 0}"
				duration=0.15
				delay="	isDockUIHidden 	? 0.6 :
						isBalancerModal ? 0.1
										: 0"
				easing="isBalancerModal ? Easing.quad_out : Easing.quad_in"
				action="kill"
				watch=false
				(bind trigger "isDockUIHidden || isBalancerModal")
			)
		)
	)
	

	
	(block
		(dispatch evRollOver args="{ isOver: true }" on='rollOver')
		(dispatch evRollOut args="{ isOver: false }" on='rollOut')

		(style
			(backgroundColor = "NO_COLOR")
			(paddingTop = "BALANCER_TOP")
			(paddingLeft = "SXS")
			(paddingRight = "SXS")
			(paddingBottom = "SXS")
		)

		
		(block
			(class $FullsizeAbsolute)
			(style (alpha = 0))

			(element BlurMapRoundedWithLayerContrastPanel)

			(block
				(bind visible "!highContrast.isEnabled")
				(class $FullsizeAbsolute)
				(style
					(alpha = 0.30)
					(backgroundColor = "0xFF001438")
					(borderRadius = "XS")
				)
			)

			(controller $Animation
				(bindcall play
					id='ubBlurAlphaAnimation'
					to="{alpha: isBalancerShows ? 1 : 0}"
					delay="	isBalancerShows ? 0 : 0.1"
					duration="	!isBalancerModal 	? 0.2 :
								isBalancerShows 	? 0.05
													: 0.2"
					easing="Easing.quad_in_out"
					action="kill"
					watch=false
					init=true
					(bind trigger "isBalancerShows")
				)
			)
		)

		
		(block
			(style
				(alpha = 0)
				(height = "BALANCER_SIZE.COLLAPSED.height")
				(width = "BALANCER_SIZE.COLLAPSED.width")
			)
			
			(controller $Animation
				(bindcall play
					id='ubResizeWidthExpandAnimation'
					keyframes = "isBalancerModal 	? 	[	{	percent: 100,
																to: { width: BALANCER_SIZE.FULL.width, alpha: 1 }}]
													:	[	{	percent: isTimeOfTheFirstShow ? 40 : 5,
																to: { alpha: 1 }},
															{	percent: 100,
																to: {width: BALANCER_SIZE.FULL.width, alpha: 1 }}]"
					duration=0.15
					easing="Easing.quad_in_out"
					action="kill"
					watch=false
					init=true
					(bind enabled "isBalancerShows")
				)

				(bindcall play
					id='ubResizeWidthExpandAnimation'
					keyframes = "isBalancerModal 	? 	[	{	percent: 100,
																to: { width: BALANCER_SIZE.COLLAPSED.width, alpha: 0 }}]
													:	[	{	percent: 99,
																to: { alpha: 1 }},
															{	percent: 100,
																to: {width: BALANCER_SIZE.COLLAPSED.width, alpha: 0 }}]"
					duration=0.16
					delay=0.15
					easing="Easing.quad_in_out"
					action="kill"
					watch=false
					(bind enabled "!isBalancerShows")
				)
			)

			(block
				(style
					(position = "absolute")
					(top = 5px)
					(left = "XS")
					(width = "BALANCER_BATTLE_IMAGE_SIZE")
					(height = "BALANCER_BATTLE_IMAGE_SIZE")
					(backgroundSize = "cover")
					(backgroundImage = "balancerHeaderData.battleTypeUrl")
				)

				(controller $Animation
					(bindcall play
						id='ubBlurAlphaAnimation'
						to="{left: isBalancerShows ? BALANCER_PADDING_LEFT_RIGHT : XS}"
						delay="isBalancerShows ? 0 : 0.1"
						duration=0.15
						easing="Easing.line"
						action="kill"
						watch=false
						init=true
						(bind trigger "isBalancerShows")
					)
				)
			)

			(block
				(style
					(position = "absolute")
					(top = 16px)
					(right = "XS")
				)

				(controller $Animation
					(bindcall play
						id='ubBlurAlphaAnimation'
						to="{right: isBalancerShows ? BALANCER_PADDING_LEFT_RIGHT : XS}"
						delay="	isBalancerShows ? 0 : 0.1"
						duration=0.15
						easing="Easing.line"
						action="kill"
						watch=false
						init=true
						(bind trigger "isBalancerShows")
					)
				)

				(tf
					(class $TextDefaultBold26NMShadowLite)
					(style
						(alpha = "TA")
						(width = "BALANCER_TIMETOWAIT_WIDTH")
					)

					(bind text "balancerHeaderData.timeToWait")
				)
			)
		)

		
		(block
			(visible = false)

			(style
				(marginTop = "XS")
				(ubScaleY = 0)
				(alpha = 0)
				(width = 100%)
			)

			(controller $Animation
				(bindcall play
					id='ubScaleYExpandAnimation'
					to= " isBalancerShows 	? { ubScaleY:1,
												alpha:1,
												visible:true }
											: {	ubScaleY:0,
												alpha:0,
												visible:false }"
					duration=0.2
					delay="isBalancerShows ? 0.1 : 0"
					easing="Easing.quad_in_out"
					action="kill"
					watch=false
					init=true
					(bind trigger "isBalancerShows")
				)
			)

			
			(block
				(isMask = true)
				(class $FullsizeAbsolute)
				(style (backgroundColor = "NO_COLOR"))
			)

			
			(block
				(style
					(width = 100%)
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)
				(element HorizontalDividerTwoPx)
			)

			
			(block
				(style
					(marginTop = "SXS")
					(height = 27px)
					(width = 100%)
					(paddingTop = "S")
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)
				(element ShipLineItemNM
					_shipId = "playerShipId"
					_withFlag = true
					_fontClass = '$TextDefaultBold20NM'
				)
			)

			
			(block
				(style
					(marginTop = "S")
					(width = 100%)
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)

				(tf
					(class $TextDefaultNM)
					(style
						(width = 100%)
						(alpha = "TC")
					)

					(bind text "averageQueueWaitingTime")
				)
			)

			
			(block
				(bind visible "isShowShipCounters || !isButtonLeaveBattleVisible")
				
				(style
					(marginTop = "M")
					(width = 100%)
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)

				(controller $Instance renderer='HorizontalDividerTwoPx'
					(bind enabled "isShowShipCounters || !isButtonLeaveBattleVisible")
				)
			)

			
			(hblock
				(bind visible "isShowShipCounters")

				(style
					(marginTop = "S")
					(hgap = "MS")
					(align = "center")
					(width = 100%)
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)

				(controller $Repeat renderer='ShipTypeCounter'
					(bind enabled "isShowShipCounters")
					(bind count "shipTypeCount")
					(args
						_shipType = "shipTypeFilters.length ? shipTypeFilters[$index].shipFilterItem.field
															: shipTypesAll[$index].shipFilterItem.field"
					)
				)
			)

			
			(block
				(bind visible "isShowShipCounters && !isButtonLeaveBattleVisible")
				
				(style
					(marginTop = "SXS")
					(width = 100%)
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)

				(controller $Instance renderer='HorizontalDividerTwoPx'
					(bind enabled "isShowShipCounters && !isButtonLeaveBattleVisible")
				)
			)

			
			(block
				(bind visible "!isButtonLeaveBattleVisible")
				(style
					(marginTop = "SXS")
					(width = 100%)
					(paddingBottom = "M")
					(paddingLeft = "BALANCER_PADDING_LEFT_RIGHT")
					(paddingRight = "BALANCER_PADDING_LEFT_RIGHT")
				)

				(controller $Instance renderer='StatusLine'
					(bind enabled "!isButtonLeaveBattleVisible")
					(args
						_text = 'IDS_LEAVE_BALANCER_WHEN_PREBATTLE'
						_textClass = '$TextDefaultNM'
						_unifiedStatus = "SC.Ui_styles.UNIFIED_STATUS.WARNING"
						_width = 100%
					)
				)
			)

			
			(block
				(bind visible "isButtonLeaveBattleVisible")
				(style
					(marginTop = "MS")
					(width = 100%)
					(paddingLeft = "XS")
					(paddingRight = "XS")
					(paddingBottom = "XS")
				)
				(controller $Instance renderer='DefaultButton'
					(bind enabled "isButtonLeaveBattleVisible")
					(args
						_name = 'buttonLeave'
						_size =	"SC.Ui_styles.SIZE.LARGE"
						_width = 100%
						_type = "SC.Ui_styles.BUTTON_TYPE.DEFAULT"
						_label = 'IDS_TOOLTIP_RANDOMBATTLE_LEAVEQUEUE'
						_isTransactionBtn = true
					)
				)
			)
		)
	)
	
)

(def element BalancerHeader ()
	(scope
		(struct balancerHeaderData = BALANCER_HEADER_DATA())

		(var sessionPrefsComoponent:dhComponent = "getSingleComponent(CC.sessionPreference)")
		(var isBalancerHideAnimationFinished:bool = "sessionPrefsComoponent.BalancerHideAnimationFinished"
															(event "sessionPrefsComoponent.evBalancerHideAnimationFinishedChanged"))

		(var isInBalancer:bool = "getSingleEntity(CC.balancerInfo) != null")

		(var saveTimeToWait:str = "balancerHeaderData.timeToWait" watch=false)
		(bind saveTimeToWait "balancerHeaderData.timeToWait != null ? balancerHeaderData.timeToWait : saveTimeToWait" watch=false
																						(bind trigger "balancerHeaderData.timeToWait"))
		(var timeToWaitResult:str = "isInBalancer ? balancerHeaderData.timeToWait : saveTimeToWait")
	)
	
	
	(bindcall externalCall 'direct.action' "['setSessionPref', {prefName: 'BalancerHideAnimationFinished', newValue: false}]" on='addedToStage')

	
	(dispatch evAnimatedBackgroundAnimationEnded dir="EventDirection.UP" reset=true delay=0.41 (bind enabled "!isInBalancer") (bind trigger "isInBalancer"))

	(style
		(align = "center|middle")
		(height = "DOCK_HEADER_HEIGHT")
		(width = 100%)
	)

	(block
		(style
			(hitTest = false)
			(width = 1920px)
			(height = "DOCK_HEADER_HEIGHT")
			(alpha = 0)
		)

		(controller $Animation
			(bindcall play
				id='ubBalacerAnimatedBackgroundAnimation'
				from="{scaleX: 1, alpha: 0}"
				to="{scaleX: 1, alpha: 1}"
				duration=0.15
				easing="Easing.quad_out"
				action="kill"
				watch=false
				init=true
				(bind enabled "isInBalancer")
			)
			(bindcall play
				id='ubBalacerAnimatedBackgroundAnimation'
				to="{alpha:0, scaleX: 1.3}"
				duration=0.4
				easing="Easing.sine_out"
				action="kill"
				watch=false
				(bind enabled "!isInBalancer")
			)
		)

		(block
			(class $Fullsize)
			(style (backgroundImage = 'url:../animations/spine/matchmaker/matchmakerPort/matchmaker.skel'))
			(colorTransform = "balancerHeaderData.colorAnimatedBackground")
			(controller $Spine
				(bindcall play sequence="[{ name:'start', repeatCount:1 }, {name: 'cycle', repeatCount:-1}]" on='addedToStage')
			)
		)
	)

	(block
		(class $MiddleAlignedAbsolutely)
		(bind visible "!isBalancerHideAnimationFinished")

		(style
			(top = "BALANCER_TOP")
			(width = "BALANCER_SIZE.COLLAPSED.width")
			(height = "BALANCER_SIZE.COLLAPSED.height")
			(alpha = 0)
		)

		(controller $Animation
			(bindcall play
				id='ubBalancerHeaderContentAnimation'
				to="{alpha: 1}"
				duration=0.2
				delay=0.1
				easing="Easing.quad_in"
				action="kill"
				watch=false
				init=true
				(bind enabled "isInBalancer")
			)
			(bindcall play
				id='ubBalancerHeaderContentAnimation'
				to="{alpha: 0}"
				duration=0.15
				easing="Easing.quad_in"
				action="kill"
				watch=false
				(bind enabled "!isInBalancer")
			)
		)

		(block
			(style
				(position = "absolute")
				(top = 5px)
				(left = "XS")
				(width = "BALANCER_BATTLE_IMAGE_SIZE")
				(height = "BALANCER_BATTLE_IMAGE_SIZE")
				(backgroundSize = "cover")
				(backgroundImage = "balancerHeaderData.battleTypeUrl")
			)
		)

		(block
			(style
				(position = "absolute")
				(top = 16px)
				(right = "XS")
			)

			(tf
				(class $TextDefaultBold26NMShadowLite)
				(style
					(alpha = "TA")
					(width = "BALANCER_TIMETOWAIT_WIDTH")
				)

				(bind text "timeToWaitResult")
			)
		)
	)
)

(def element ModalWindowUpperSlidingBalancer ()
	(macro MODAL_WINDOW_INIT)

	(controller $Animation
		(bindcall play 
			id='ModalWindowUpperSlidingBalancerHide'
			duration=0.15
			to="{ alpha: 0 }"
			action="kill"
			(event "startHide")
		)
	)

	(element UpperSlidingBalancer)
)
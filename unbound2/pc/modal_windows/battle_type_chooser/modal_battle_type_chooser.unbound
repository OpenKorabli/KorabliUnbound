(def css $BattleTypeIconSize()
	(width = 112px)
	(height = 112px)
)

(def css $BattleTypeIconSmallSize()
	(width = 90px)
	(height = 90px)
)

(def constant BATTLE_TYPE_EVENT_CARD_HEIGHT 624px)
(def constant BATTLE_TYPE_COMMON_CARD_HEIGHT 300px)
(def constant BATTLE_TYPE_COMMON_CARD_WIDTH 400px)

(def constant BATTLE_TYPE_EVENT_CARD_HEIGHT_SMALL 462px)
(def constant BATTLE_TYPE_COMMON_CARD_HEIGHT_SMALL 225px)
(def constant BATTLE_TYPE_COMMON_CARD_WIDTH_SMALL 300px)

(def constant BATTLE_TYPE_CAROUSEL_PADDING 88px)
(def constant BATTLE_TYPE_CAROUSEL_PADDING_SMALL 21px)

(def constant BATTLE_TYPES_CT "{
	SC.Common.BATTLE_TYPES.PVE_BATTLE:			{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 12, greenOffset: 148, blueOffset: 150},
	SC.Common.BATTLE_TYPES.EVENT_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 140, greenOffset: 100, blueOffset: 177},
	SC.Common.BATTLE_TYPES.RANKED_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 209, greenOffset: 96, blueOffset: 40},
	SC.Common.BATTLE_TYPES.CLAN_BATTLE:			{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 209, greenOffset: 96, blueOffset: 40},
	SC.Common.BATTLE_TYPES.BRAWL_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 140, greenOffset: 100, blueOffset: 177},
	SC.Common.BATTLE_TYPES.RATING_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 209, greenOffset: 96, blueOffset: 40},
	SC.Common.BATTLE_TYPES.TRIAL_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 54, greenOffset: 134, blueOffset: 171},
	SC.Common.BATTLE_TYPES.COOPERATIVE_BATTLE:	{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 12, greenOffset: 148, blueOffset: 150},
	SC.Common.BATTLE_TYPES.RANDOM_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 188, greenOffset: 47, blueOffset: 57},
	SC.Common.BATTLE_TYPES.TOURNAMENT_BATTLE:	{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 209, greenOffset: 96, blueOffset: 40},
	SC.Common.BATTLE_TYPES.TRAINING_BATTLE:		{redMultiplier:0, greenMultiplier:0, blueMultiplier:0, redOffset: 54, greenOffset: 134, blueOffset: 171}
}")

(def constant BATTLE_SPECIFICS {
	MODIFIERS:			0,
	CUSTOM_SETTINGS:	1,
	FOG_OF_WAR:			2,
	RESOURCE_NO_WASTE:	3,
	HAS_ACHIEVEMENTS:	4,
	TUTORIAL_HINTS:		5,
	UNIQUE_SCENARIO:	6,
	BIGGER_REWARD:		7
})

(def constant BATTLETYPE_CARD_HOVER_ALPHA {
	SC.Ui_styles.BUTTON_STATE.UP:				0,
	SC.Ui_styles.BUTTON_STATE.OVER:				1,
	SC.Ui_styles.BUTTON_STATE.DOWN:				1,
	SC.Ui_styles.BUTTON_STATE.SELECTED:			0,
	SC.Ui_styles.BUTTON_STATE.SELECTED_OVER:	1,
	SC.Ui_styles.BUTTON_STATE.SELECTED_DOWN:	1,
	SC.Ui_styles.BUTTON_STATE.DISABLED:			0
})

(def constant BATTLETYPE_CARD_RULES_ALPHA "{
	SC.Ui_styles.BUTTON_STATE.UP:				1,
	SC.Ui_styles.BUTTON_STATE.OVER:				0,
	SC.Ui_styles.BUTTON_STATE.DOWN:				0,
	SC.Ui_styles.BUTTON_STATE.SELECTED:			1,
	SC.Ui_styles.BUTTON_STATE.SELECTED_OVER:	0,
	SC.Ui_styles.BUTTON_STATE.SELECTED_DOWN:	0,
	SC.Ui_styles.BUTTON_STATE.DISABLED:			TC
}")

(def constant BATTLETYPE_CARD_TOOLTIP "{
	SC.Common.BATTLE_TYPES.EVENT_BATTLE:		'EventBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.PVE_BATTLE:			'PVEOperationTooltip',
	SC.Common.BATTLE_TYPES.CLAN_BATTLE:			'ClanBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.RANKED_BATTLE:		'RankedBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.RATING_BATTLE:		'RatingBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.BRAWL_BATTLE:		'BrawlBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.TRIAL_BATTLE:		'CommonBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.COOPERATIVE_BATTLE:	'CommonBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.RANDOM_BATTLE:		'CommonBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.TOURNAMENT_BATTLE:	'CommonBattleTypeTooltip',
	SC.Common.BATTLE_TYPES.TRAINING_BATTLE:		'CommonBattleTypeTooltip'
}")

(def element ModalWindowBattleTypeChooser ()
	(macro MODAL_WINDOW_INIT)
	(macro MODAL_WINDOW_BG)

	(scope
		(event evScrollToIndex)
		(event evScrollToLeft)
		(event evScrollToRight)
		(event evCarouselCanScrollChanged)

		(var carouselCanScrollLeft:bool = "$event ? $event.down : false" (event "evCarouselCanScrollChanged"))
		(var carouselCanScrollRight:bool = "$event ? $event.up : false" (event "evCarouselCanScrollChanged"))
		(var canScroll:bool = "carouselCanScrollLeft || carouselCanScrollRight")

		
		(var isNotSmallScreenSize:bool = "stageWidth > 1850px && stageHeight > 900px")
		(var battletypeCardHeight:number = "isNotSmallScreenSize ? BATTLE_TYPE_COMMON_CARD_HEIGHT : BATTLE_TYPE_COMMON_CARD_HEIGHT_SMALL")
		(var battletypeCardWidth:number = "isNotSmallScreenSize ? BATTLE_TYPE_COMMON_CARD_WIDTH : BATTLE_TYPE_COMMON_CARD_WIDTH_SMALL")
		(var battletypeEventCardHeight:number = "isNotSmallScreenSize ? BATTLE_TYPE_EVENT_CARD_HEIGHT : BATTLE_TYPE_EVENT_CARD_HEIGHT_SMALL")

		(var selectedBattleTypeEntity:dhEntity = "getSingleEntity(CC.battleType, 'selected')")
		(var firstTrialEntity:dhEntity = "getSingleEntity(CC.trial)")
		(var isTrialBattleType:bool = "selectedBattleTypeEntity.hasComponent(CC.trial)")
		(var selectedRuleBattleTypeId:number = "isTrialBattleType ? firstTrialEntity.id : selectedBattleTypeEntity.id")
		(var sortedChooserBattleTypes:dhCollection = "getCollectionByPath(CC.battleType, 'forChooser.sortedForChooser')")

		(var trialEntity:dhEntity = "isTrialBattleType ? selectedBattleTypeEntity : firstTrialEntity")
	)

	(class $Fullsize)

	
	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
		(style (width = 100%))

		(element ModalWindowHeaderFullSize
			_windowName = 'IDS_CHOOSE_BATTLETYPE_HEADER'
			_paddingRight = "M"
			_paddingLeft = "M"
			_methods = "[{ type: 'inputMapping.onRequest', name: 'closeModalSelectBattleType', args: {} }]"
		)
	)

	
	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
		(style
			(width = 100%)
			(marginTop = "{ 720:LM, 1080:114px }")
			
			(bind height "battletypeEventCardHeight + S")
			(bind paddingLeft "isNotSmallScreenSize ? BATTLE_TYPE_CAROUSEL_PADDING : BATTLE_TYPE_CAROUSEL_PADDING_SMALL")
			(bind paddingRight "isNotSmallScreenSize ? BATTLE_TYPE_CAROUSEL_PADDING : BATTLE_TYPE_CAROUSEL_PADDING_SMALL")
		)

		(scrollArea
			(class $Fullsize)

			(macro DEFAULT_HORIZONTAL_SCROLL_PARAMS
				_singleStep = "battletypeCardWidth + SXS"
				_canScrollChangedEvent = "'evCarouselCanScrollChanged'"
				_isScrollBarVisible = "false"
			)

			(bind useMask "canScroll")
			(repeatController = 'battleTypeContainer')

			(content
				(style
					(flow = "tile_vertical")
					(align = "center|top")
					(height = 100%)
					(paddingTop = "S")
					(bind hgap "isNotSmallScreenSize ? LM : SXS")
					(bind vgap "isNotSmallScreenSize ? MS : SXS")
				)

				
				(controller $Repeat renderer='BattleTypeCard' name='battleTypeContainer'
					(bind items "sortedChooserBattleTypes")
					(args
						_cardHeight = "battletypeCardHeight"
						_cardWidth = "battletypeCardWidth"
						_cardEventHeight = "battletypeEventCardHeight"
						_size = "isNotSmallScreenSize ? SIZE.MEDIUM : SIZE.SMALL"
						_battleTypeEntity = "	$item.battleType.type == SC.Common.BATTLE_TYPES.TRIAL_BATTLE	?	trialEntity
																												:	$item"
					)
				)
			)

			(bindcall scrollToBegin animated=true maxAnimatedDistance=1300px (event "evScrollToLeft"))
			(bindcall scrollToEnd animated=true maxAnimatedDistance=1300px (event "evScrollToRight"))
			(bindcall scrollTo index="$event._scrollToIndex" animated=true maxAnimatedDistance=1300px (event "evScrollToIndex"))
		)

		
		(controller $Instance renderer = 'BattleTypeCarouselScrollButton'
			(bind enabled "canScroll")
			(args
				_direction = "ScrollDirection.LEFT"
				_isNotSmallScreenSize = "isNotSmallScreenSize"
				_isScrollable = "carouselCanScrollLeft"
			)
		)

		
		(controller $Instance renderer = 'BattleTypeCarouselScrollButton'
			(bind enabled "canScroll")
			(args
				_direction = "ScrollDirection.RIGHT"
				_isNotSmallScreenSize = "isNotSmallScreenSize"
				_isScrollable = "carouselCanScrollRight"
			)
		)
	)

	
	(block
		(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
		(class $Fullsize)
		(style
			(align = "middle")
			
			(bind paddingLeft "isNotSmallScreenSize ? BATTLE_TYPE_CAROUSEL_PADDING + XXS : BATTLE_TYPE_CAROUSEL_PADDING_SMALL + XXS")
		)

		(tf
			(bind class "isNotSmallScreenSize ? '$TextDefault20NM' : '$TextDefaultNM'")
			(style
				(width = 500px)
				(alpha = "TA")
				(bind marginBottom "isNotSmallScreenSize ? MS : M")
			)
			(text = 'IDS_BATTLETYPE_RULES_DESCRIPTION')
		)

		(element DefaultButton
			_type = "SC.Ui_styles.BUTTON_TYPE.SECONDARY"
			_size = "isNotSmallScreenSize ? SC.Ui_styles.SIZE.MEDIUM : SC.Ui_styles.SIZE.SMALL"
			_width = "isNotSmallScreenSize ? 160px : 120px"
			_label = 'IDS_BATTLE_RULES'
			_methods = "[{	type: 'inputMapping.onRequest',
							name: 'showBattleTypeRules',
							args: { _selectedBattleTypeId: selectedRuleBattleTypeId}}]"
		)
	)
)
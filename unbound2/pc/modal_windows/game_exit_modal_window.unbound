(def element ConfirmExitGameModalWindow ()
	(macro MODAL_WINDOW_INIT)
	(macro MODAL_WINDOW_BG)
	(scope
		(var battleInfoComponent:dhComponent = "getSingleEntity(CC.battleData).battleInfo")
		(var isTrainingBattle:bool = "battleInfoComponent.battleType == SC.Common.BATTLE_TYPES.TRAINING_BATTLE")
		(var isReplayPlaying:bool = "battleInfoComponent.isReplayPlaying")

		(var playerAvatarComponent:dhComponent = "getSingleComponent(CC.playerAvatar)")
		(var isAlive:bool = "playerAvatarComponent.isAlive" (event "playerAvatarComponent.evIsAliveChanged"))

		(var isEarlyExitContentVisible:bool = "isAlive && !isTrainingBattle && !isReplayPlaying")
		(var headerExitBattle:str = "isEarlyExitContentVisible	? 'IDS_WINDOW_HEADER_EARLY_EXIT_BATTLE'
																: 'IDS_WINDOW_HEADER_CONFIRMATION'")
	)

	(block
		(class $EyeLevelAligned)
		(style
			(align = "center")
			(width = "DEFAULT_MODAL_WINDOW_WIDTH")
		)

		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 1)
			(style (width = 100%))
			(element ModalWindowShortHeader _header = "headerExitBattle")
		)

		(block
			(bind visible "isEarlyExitContentVisible")
			(style
				(align = "center")
				(width = 100%)
			)
			(block
				(macro DEFAULT_MODAL_WINDOW_ANIMATION 2)
				(style
					(width = 470px)
					(height = 200px)
					(marginTop = "M")
					(backgroundImage = 'url:../service_kit/premature_exit/premature_battle_exit.png')
				)
			)
			(block
				(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)
				(style (width = 100%))
				(tf
					(class $TextDefault22NM)
					(style
						(width = 100%)
						(marginTop = "MS")
						(textAlign = "center")
						(alpha = "TC")
					)
					(text = 'IDS_EARLY_EXIT_BATTLE_ATTENTION')
				)
			)
			(block
				(macro DEFAULT_MODAL_WINDOW_ANIMATION 3.5)
				(style
					(width = 100%)
					(marginTop = "MS")
				)
				(element HorizontalDividerTwoPx)
			)
		)
		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 3)
			(tf
				(class $TextDefault26NM)
				(style
					(alpha = "TA")
					(marginTop = "MS")
				)
				(text = 'IDS_CONFIRM_EXIT_GAME')
			)
		)
		(block
			(macro DEFAULT_MODAL_WINDOW_ANIMATION 4)
			(style (marginTop = "MS"))
			(element ModalWindowSystemYesNoButtons
				_btnOkName = 'btn_ok'
				_isBtnOkDefaultFocused = "!isEarlyExitContentVisible"
				_isBtnNoDefaultFocused = "isEarlyExitContentVisible"
			)
		)
	)
)
